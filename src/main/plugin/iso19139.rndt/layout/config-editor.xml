<?xml version="1.0" encoding="UTF-8"?>
<editor xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="../../../../../../config-editor.xsd"
        xmlns:xs="http://www.w3.org/2001/XMLSchema"
        xmlns:gn="http://www.fao.org/geonetwork"
        xmlns:gco="http://www.isotc211.org/2005/gco"
        xmlns:gmd="http://www.isotc211.org/2005/gmd"
        xmlns:gmx="http://www.isotc211.org/2005/gmx"
        xmlns:srv="http://www.isotc211.org/2005/srv"
        xmlns:gml="http://www.opengis.net/gml/3.2"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        >

  <!-- Form field type configuration. Default is text. -->
  <fields>
    <for name="gmd:abstract" use="textarea"/>
    <for name="gmd:credit" use="textarea"/>
    <for name="gmd:description" use="textarea"/>
    <for name="gmd:explanation" use="textarea"/>
    <for name="gmd:handlingDescription" use="textarea"/>
    <for name="gmd:maintenanceNote" use="textarea"/>
    <for name="gmd:purpose" use="textarea"/>
    <for name="gmd:orderingInstructions" use="textarea"/>
    <for name="gmd:statement" use="textarea"/>
    <for name="gmd:supplementalInformation" use="textarea"/>
    <for name="gmd:specificUsage" use="textarea"/>
    <for name="gmd:userNote" use="textarea"/>
    <for name="gmd:useLimitation" use="textarea"/>
    <for name="gmd:title" use="textarea"/>
    <for name="gmd:URL" use="textarea"/>
    <for name="gmd:individualName" use="textarea"/>
    <for name="gml:identifier" use="textarea"/>
    <for name="gmd:nameOfMeasure" use="textarea"/>
    <for name="gmd:evaluationMethodDescription" use="textarea"/>
    <for name="gco:Record" use="number"/>
    <for name="gco:Measure" use="number"/>
    <for name="gco:Distance" use="number"/>
    <for name="gco:Decimal" use="number"/>
    <for name="gco:Integer" use="number"/>
    <for name="gco:Real" use="number"/>
    <for name="gco:Boolean" use="checkbox"/>
    <for name="gco:CharacterString" use="textarea"/>
    <for name="gml:coordinates" use="textarea"/>
    <for name="gml:name" use="textarea"/>
    <for name="gco:Date" use="date"/>
    <for name="gco:DateTime" use="datetime"/>

    <for name="gco:aName" use ="textarea"/>
    <for name="gco:Name" use="textarea"/>
    <!-- gmx:FileName/@src attribute -->
    <for name="src" use="data-gn-logo-selector"/>
    <for name="gmd:electronicMailAddress" use="email"/>
    <for name="gmd:country" use="data-gn-country-picker"/>
    <for name="gmd:referenceSystemInfo" addDirective="data-gn-crs-selector"/>
    <for name="gmd:MD_ScopeCode" use="textarea"/>
    <for name="gmd:contact" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
        data-template-add-action="true"
        data-search-action="true"
        data-popup-action="true"
        data-template-type="contact"
        data-insert-modes=""
        data-filter='{"_root": "gmd:CI_ResponsibleParty"}'
        data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{role}"/>
    </for>
    <for name="gmd:pointOfContact" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
        data-template-add-action="true"
        data-search-action="true"
        data-popup-action="true"
        data-template-type="contact"
        data-insert-modes=""
        data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{role}"/>
    </for>
    <for name="gmd:distributorContact" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
        data-template-add-action="true"
        data-search-action="true"
        data-popup-action="true"
        data-template-type="contact"
        data-insert-modes=""
        data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{role}"/>
    </for>
    <for name="gmd:processor" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
        data-template-add-action="true"
        data-search-action="true"
        data-popup-action="true"
        data-template-type="contact"
        data-insert-modes=""
        data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{role}"/>
    </for>
    <for name="gmd:citedResponsibleParty" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
        data-template-add-action="true"
        data-search-action="true"
        data-popup-action="true"
        data-template-type="contact"
        data-insert-modes=""
        data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{role}"/>
    </for>

    <!--for name="gmx:Anchor" use="data-gn-keyword-picker">
      <directiveAttributes
        data-display-definition="true"
        data-thesaurus-concept-id-attribute="xlinkCOLONhref"/>
    </for-->

 </fields>


 <fieldsWithFieldset>
   <name>gmd:MD_Metadata</name>
   <name>gmd:identificationInfo</name>
   <name>gmd:pointOfContact</name>
   <name>gmd:distributorContact</name>
   <name>gmd:contact</name>
   <name>gmd:distributionInfo</name>
   <name>gmd:portrayalCatalogueInfo</name>
   <name>gmd:portrayalCatalogueCitation</name>
   <name>gmd:spatialRepresentationInfo</name>
   <name>gmd:graphicOverview</name>
   <name>gmd:citedResponsibleParty</name>
   <name>gmd:dataQualityInfo</name>
   <name>gmd:contentInfo</name>
   <name>gmd:distributionFormat</name>
   <name>gmd:referenceSystemInfo</name>
   <name>gmd:offLine</name>
   <name>gmd:onLine</name>
   <name>gmd:projection</name>
   <name>gmd:ellipsoid</name>
   <name>gmd:attributes</name>
   <name>gmd:MD_Identifier</name>
   <name>gmd:thesaurusName</name>
   <name>gmd:geographicBox</name>
   <name>gmd:EX_TemporalExtent</name>
   <name>gmd:MD_Distributor</name>
   <name>srv:containsOperations</name>
   <name>srv:SV_OperationMetadata</name>
   <name>srv:parameters</name>
   <name>srv:SV_Parameter</name>
   <name>gmd:metadataConstraints</name>
   <name>gmd:aggregationInfo</name>
   <name>gmd:processStep</name>
   <name>gmd:lineage</name>
   <name>gmd:centerPoint</name>
   <name>gmd:EX_VerticalExtent</name>
   <name>gml:verticalCS</name>
   <name>gml:verticalDatum</name>
   <name>gmd:identifier</name>
   <name>gmd:axisDimensionProperties</name>
   <name>gmd:MD_ImageDescription</name>
   <name>gmd:contentType</name>
   <name>gmd:dimension</name>
   <name>gmd:presentationForm</name>
   <name>gco:Record</name>
   <name>gmd:resourceMaintenance</name>
   <name>gmd:MD_MaintenanceInformation</name>
   <name>gmd:minimumValue</name>
   <name>gmd:maximumValue</name>
 </fieldsWithFieldset>

 <multilingualFields>
   <!-- In multilingual mode, define which mode
   the widget should have. If expanded, then one
   field per language is displayed. -->
    <expanded>
      <name>gmd:title</name>
      <name>gmd:abstract</name>
    </expanded>
    <!-- All fields in ISO could be multilingual.
    Define element to exclude.

      The name element can optionally have ancestor, child or parent attributes to
      further restrict the exclusion.  For example if some gmd:code elements are
      multilingual but others are not then adding a parent/child/parent attribute
      can restrict the exclude to only some elements.

      For example:
        <name ancestor="gmd:thesaurusName">gmd:code</name>
        or
        <name child="gmx:Anchor">gmd:code</name>
    -->
    <exclude>
      <name>gmd:identifier</name>

      <name>gmd:dataSetURI</name>
      <name>gmd:postalCode</name>
      <name>gmd:language</name>
      <name>gmd:voice</name>
      <name>gmd:facsimile</name>
      <name>gmd:dataset</name>
      <name>gmd:page</name>
      <name>gmd:date</name>
      <name>gmd:linkage</name>
      <name>gmd:fileName</name>
      <name>gmd:protocol</name>
      <name>gmd:fileType</name>
      <name>gmd:unitsOfDistribution</name>
      <name>gmd:amendmentNumber</name>
      <name>gmd:fileDecompressionTechnique</name>
      <name>gmd:turnaround</name>
      <name>gmd:userDeterminedLimitations</name>
      <name>gmd:codeSpace</name>
      <name>gmd:version</name>
      <name>gmd:edition</name>
      <name>gmd:ISBN</name>
      <name>gmd:ISSN</name>
      <name>gmd:errorStatistic</name>
      <name>gmd:schemaAscii</name>
      <name>gmd:softwareDevelopmentFileFormat</name>
      <name>gmd:condition</name>
      <name>gmd:maximumOccurence</name>
      <name>gmd:domainValue</name>
      <name>gmd:densityUnits</name>
      <name>gmd:descriptor</name>
      <name>gmd:denominator</name>
      <name>gmd:distance</name>
      <name>srv:invocationName</name>
      <name>srv:serviceTypeVersion</name>
      <name>srv:operationName</name>
      <name>srv:identifier</name>
      <name ancestor="gmd:thesaurusName">gmd:code</name>
      <name ancestor="gmd:aggregateDataSetIdentifier">gmd:code</name>
      <name ancestor="gmd:CI_Citation">gmd:code</name>
    </exclude>
  </multilingualFields>
  <tableFields>
    <table for="gmd:CI_ResponsibleParty" fieldset="true">
      <header>
        <col label="gmd:organisationName"/>
        <col label="gmd:electronicMailAddress"/>
        <col label="gmd:phone"/>
        <col label="gmd:URL"/>
        <col label="gmd:role"/>
        <col/>
      </header>
      <row>
        <col xpath="gmd:organisationName"/>
        <col xpath="gmd:contactInfo/gmd:CI_Contact/gmd:address/gmd:CI_Address/gmd:electronicMailAddress"/>
        <col xpath="gmd:contactInfo/gmd:CI_Contact/gmd:phone/gmd:CI_Telephone/gmd:voice"/>
        <col xpath="gmd:contactInfo/gmd:CI_Contact/gmd:onlineResource/gmd:CI_OnlineResource/gmd:linkage"/>
        <col xpath="gmd:role"/>
        <col del=".."/>
      </row>
    </table>

    <table for="gmd:distributorContact" fieldset="true">
      <header>
        <col label="gmd:organisationName"/>
        <col label="gmd:electronicMailAddress"/>
        <col label="gmd:phone"/>
        <col label="gmd:URL"/>
        <col label="gmd:role"/>
        <col/>
      </header>
      <row>
        <col xpath="gmd:CI_ResponsibleParty/gmd:organisationName"/>
        <col xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/gmd:CI_Contact/gmd:address/gmd:CI_Address/gmd:electronicMailAddress"/>
        <col xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/gmd:CI_Contact/gmd:phone/gmd:CI_Telephone/gmd:voice"/>
        <col xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/gmd:CI_Contact/gmd:onlineResource/gmd:CI_OnlineResource/gmd:linkage"/>
        <col xpath="gmd:CI_ResponsibleParty/gmd:role"/>
        <col del="../.."/>
      </row>
    </table>

    <table for="srv:SV_CoupledResource">
      <header>
        <col label="srv:operationName"/>
        <col label="gco:ScopedName"/>
        <col label="srv:identifier"/>
        <col/>
      </header>
      <row>
        <col xpath="srv:operationName"/>
        <col xpath="gco:ScopedName"/>
        <col xpath="srv:identifier"/>
        <col del=".."/>
      </row>
    </table>
    <table for="gmd:MD_Format">
      <header>
        <col label="gmd:name"/>
        <col label="gmd:version"/>
        <col/>
      </header>
      <row>
        <col xpath="gmd:name"/>
        <col xpath="gmd:version"/>
        <col del=".."/>
      </row>
    </table>
    <table for="gmd:PT_Locale">
      <header>
        <col label="gmd:languageCode"/>
        <col label="gmd:characterEncoding"/>
        <col/>
      </header>
      <row>
        <col xpath="gmd:languageCode"/>
        <col xpath="gmd:characterEncoding"/>
        <col del=".."/>
      </row>
    </table>
  </tableFields>

  <!-- View configuration -->
  <views>

    <!-- View RNDT tab for conformity class -->

    <view name="rndt-view" upAndDownControlHidden="true">

      <sidePanel>
        <directive data-gn-validation-report=""/>
        <directive data-gn-onlinesrc-list=""
                   data-types="thumbnail|parent|dataset|service|fcats"/>
        <directive data-gn-suggestion-list=""/>
        <directive data-gn-need-help="user-guide/describing-information/creating-metadata.html"/>
      </sidePanel>

        <thesaurusList>
           <thesaurus key="external.theme.httpinspireeceuropaeutheme-theme"
                      fieldset="false"
                      transformations="to-iso19139-keyword-with-anchor"/>
           <thesaurus key="external.theme.rndt-all1"
                      maxtags="1"
                      fieldset="false"
                      transformations="to-iso19139-keyword-with-anchor"/>   
        </thesaurusList>

      <tab id="default" default="true" mode="flat">

        <section name="metadataInfo">

          <field xpath="/gmd:MD_Metadata/gmd:fileIdentifier"/>

          <field name="language"
            xpath="/gmd:MD_Metadata/gmd:language/gmd:LanguageCode" del=".."/>

          <action type="add" btnLabel="language"
                  or="language"
                  in="/gmd:MD_Metadata">
            <template>
              <snippet>
                <gmd:language>
                  <gmd:LanguageCode codeList="http://www.loc.gov/standards/iso639-2/#LanguageCode" codeListValue="ita"/>
                </gmd:language>
              </snippet>
            </template>
          </action>


          <field xpath="/gmd:MD_Metadata/gmd:characterSet" or="characterSet" in ="/gmd:MD_Metadata"/>

          <action type="add" btnLabel="characterSet" or="characterSet" in="/gmd:MD_Metadata">
            <template>
              <snippet>
                <gmd:characterSet>
                  <gmd:MD_CharacterSetCode codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#MD_CharacterSetCode"
                                           codeListValue="utf8">utf8</gmd:MD_CharacterSetCode>
                </gmd:characterSet>
              </snippet>
            </template>
          </action>

          <field xpath="/gmd:MD_Metadata/gmd:parentIdentifier" del="."/>

          <action type="add" or ="parentIdentifier" in="/gmd:MD_Metadata" btnLabel="parentIdentifier">
            <template>
              <snippet>
                <gmd:parentIdentifier>
                  <gco:CharacterString></gco:CharacterString>
                </gmd:parentIdentifier>
              </snippet>
            </template>
          </action>


            <field xpath="/gmd:MD_Metadata/gmd:contact" del=".">
              <template>
                <values readonlyIf="count(@xlink:href) > 0">
                  <key label="organisationName"
                       xpath="gmd:CI_ResponsibleParty/gmd:organisationName/gco:CharacterString"/>
                  <key label="electronicMailAddress"
                       xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:address/gmd:CI_Address/gmd:electronicMailAddress/gco:CharacterString"
                       use="email"/>
                  <key label="phone"
                       xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:phone/gmd:CI_Telephone/gmd:voice/gco:CharacterString"/>
                  <key label="url"
                       xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:onlineResource/gmd:CI_OnlineResource/gmd:linkage/gmd:URL"/>
                  <key label="role"
                       xpath="gmd:CI_ResponsibleParty/gmd:role/gmd:CI_RoleCode/@codeListValue">
                    <codelist name="gmd:CI_RoleCode"/>
                  </key>
                </values>
                <snippet>
                  <gmd:CI_ResponsibleParty>
                    <gmd:organisationName>
                      <gco:CharacterString>{{organisationName}}</gco:CharacterString>
                      <gn:copy select="gmd:PT_FreeText"/>
                    </gmd:organisationName>
                    <gmd:contactInfo>
                      <gmd:CI_Contact>
                        <gmd:phone>
                          <gmd:CI_Telephone>
                            <gmd:voice>
                              <gco:CharacterString>{{phone}}</gco:CharacterString>
                              <gn:copy select="gmd:PT_FreeText"/>
                            </gmd:voice>
                          </gmd:CI_Telephone>
                        </gmd:phone>
                        <gmd:address>
                          <gmd:CI_Address>
                            <gmd:electronicMailAddress>
                              <gco:CharacterString>{{electronicMailAddress}}</gco:CharacterString>
                              <gn:copy select="gmd:PT_FreeText"/>
                            </gmd:electronicMailAddress>
                          </gmd:CI_Address>
                        </gmd:address>
                        <gmd:onlineResource>
                          <gmd:CI_OnlineResource>
                            <gmd:linkage>
                              <gmd:URL>{{url}}</gmd:URL>
                              <gn:copy select="gmd:PT_FreeText"/>
                            </gmd:linkage>
                          </gmd:CI_OnlineResource>
                        </gmd:onlineResource>
                      </gmd:CI_Contact>
                    </gmd:contactInfo>
                    <gmd:role>
                      <gmd:CI_RoleCode
                        codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/codelist/ML_gmxCodelists.xml#CI_RoleCode"
                        codeListValue="{{role}}"/>
                    </gmd:role>
                  </gmd:CI_ResponsibleParty>
                </snippet>
              </template>
            </field>

            <action type="add"
                    or="contact" in="/gmd:MD_Metadata"
                    btnClass="fa fa-user-plus"
                    addDirective="data-gn-directory-entry-selector">
              <directiveAttributes
                data-template-add-action="true"
                data-search-action="true"
                data-popup-action="true"
                data-template-type="contact"
                data-insert-modes=""
                data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{role}"/>
            </action>

          <field xpath="/gmd:MD_Metadata/gmd:dateStamp" or ="dateStamp" in="/gmd:MD_Metadata"/>
          <field xpath="/gmd:MD_Metadata/gmd:metadataStandardName" or="metadataStandardName" in="/gmd:MD_Metadata"/>

          <field xpath="/gmd:MD_Metadata/gmd:metadataStandardVersion" or="metadataStandardVersion" in="/gmd:MD_Metadata"/>

        </section>

        <section name="identificationInfo">

          <field
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation/gmd:title"
            or="title" in="/gmd:MD_Metadata/gmd:identificationInfo/*"/>

          <field xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation/gmd:date[boolean(gmd:CI_Date/gmd:date/gco:Date)]"/>

          <field xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation/gmd:date[boolean(gmd:CI_Date/gmd:date/gco:DateTime)]"/>


          <action type="add" name="referenceDate" or="date"
                  btnLabel="addDate"
                  in="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation">
            <template>
              <snippet>
                <gmd:date>
                  <gmd:CI_Date>
                    <gmd:date>
                      <gco:Date></gco:Date>
                    </gmd:date>
                    <gmd:dateType>
                      <gmd:CI_DateTypeCode
                        codeList="http://www.isotc211.org/2005/resources/codeList.xml#CI_DateTypeCode"
                        codeListValue="creation"/>
                    </gmd:dateType>
                  </gmd:CI_Date>
                </gmd:date>
              </snippet>
            </template>
          </action>

            <field
                   xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation/gmd:citedResponsibleParty" del=".">
              <template>
                <values readonlyIf="count(@xlink:href) > 0">
                  <key label="organisationName"
                       xpath="gmd:CI_ResponsibleParty/gmd:organisationName/gco:CharacterString"/>
                  <key label="electronicMailAddress"
                       xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:address/gmd:CI_Address/gmd:electronicMailAddress/gco:CharacterString"
                       use="email"/>
                  <key label="phone"
                       xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:phone/gmd:CI_Telephone/gmd:voice/gco:CharacterString"/>
                  <key label="url"
                       xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:onlineResource/gmd:CI_OnlineResource/gmd:linkage/gmd:URL"/>
                  <key label="role"
                       xpath="gmd:CI_ResponsibleParty/gmd:role/gmd:CI_RoleCode/@codeListValue">
                    <codelist name="gmd:CI_RoleCode"/>
                  </key>
                </values>
                <snippet>
                  <gmd:citedResponsibleParty>
                    <gmd:CI_ResponsibleParty>
                      <gmd:organisationName>
                        <gco:CharacterString>{{organisationName}}</gco:CharacterString>
                        <gn:copy select="gmd:PT_FreeText"/>
                      </gmd:organisationName>
                      <gmd:contactInfo>
                        <gmd:CI_Contact>
                          <gmd:phone>
                            <gmd:CI_Telephone>
                              <gmd:voice>
                                <gco:CharacterString>{{phone}}</gco:CharacterString>
                                <gn:copy select="gmd:PT_FreeText"/>
                              </gmd:voice>
                            </gmd:CI_Telephone>
                          </gmd:phone>
                          <gmd:address>
                            <gmd:CI_Address>
                              <gmd:electronicMailAddress>
                                <gco:CharacterString>{{electronicMailAddress}}</gco:CharacterString>
                                <gn:copy select="gmd:PT_FreeText"/>
                              </gmd:electronicMailAddress>
                            </gmd:CI_Address>
                          </gmd:address>
                          <gmd:onlineResource>
                            <gmd:CI_OnlineResource>
                              <gmd:linkage>
                                <gmd:URL>{{url}}</gmd:URL>
                                <gn:copy select="gmd:PT_FreeText"/>
                              </gmd:linkage>
                            </gmd:CI_OnlineResource>
                          </gmd:onlineResource>
                        </gmd:CI_Contact>
                      </gmd:contactInfo>
                      <gmd:role>
                        <gmd:CI_RoleCode
                          codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/codelist/ML_gmxCodelists.xml#CI_RoleCode"
                          codeListValue="{{role}}"/>
                      </gmd:role>
                    </gmd:CI_ResponsibleParty>
                  </gmd:citedResponsibleParty>
                </snippet>
              </template>
            </field>

            <action type="add" btnClass="fa fa-user-plus" name="responsible" or="citedResponsibleParty"
                    in="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation" addDirective="data-gn-directory-entry-selector">
              <directiveAttributes
                data-template-add-action="true"
                data-search-action="true"
                data-popup-action="true"
                data-template-type="contact"
                data-insert-modes=""
                data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{role}"/>
            </action>

          <field name="datasetcode"
                 xpath="/gmd:MD_Metadata/gmd:identificationInfo/*
                 /gmd:citation/gmd:CI_Citation/gmd:identifier/*/gmd:code"/>

          <field
                 xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:abstract"
                 or="abstract"
                 in="/gmd:MD_Metadata/gmd:identificationInfo/*"/>

          <!-- parole chiave per metadati comuni.
             vanno escluse le keyword relative a serie/dataset:
               (3.2.4.1) INSPIRE themes
               (3.2.4.2) dataset prioritari
               (3.2.4.3) applicazioni territoriali
               (3.2.4.4) opendata
               (3.2.4.5) interesse generale
             vanno escluse le keyword relative a servizi:
               (4.1.2.1) gestire keyword INSPIRE service types
             vanno esclusi i thesauri usati come codelist 
                    Conditions Applying To Access and Use
                    regions
                    Indice Pubblica amministrazione
                    INSPIRE Protocol values
                    Limitations on public access
                    Online description code
                    Tipo di servizio di dati territoriali               
          -->

          <section name="descriptiveKeywords">

            <!-- Keywords con thesauri (non quelli gestiti altrove) -->
            <field xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords[boolean(gmd:MD_Keywords/gmd:thesaurusName)
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'GEMET - INSPIRE themes, version 1.0'))
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'INSPIRE priority data set'))
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'Spatial scope'))
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'Registro dei dati di interesse generale per il RNDT'))
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'REGOLAMENTO (CE) N. 1205/2008'))
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'Conditions Applying To Access and Use'))
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'Continents, countries, sea regions of the world'))
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'Indice Pubblica Amministrazione'))
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'INSPIRE Protocol values'))
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'Limitations on public access'))
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'Online description code'))
                     and not(contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(), 'Spatial data service type'))
                     ]"
                   notDisplayedIfMissing="true"
                   name="keyword_con_thesaurus"
                   or = "descriptiveKeywords" in = "gmd:MD_Metadata/gmd:identificationInfo/*"
                   del="."
            >
            </field>

            <!--
              Vogliamo poter aggiungere un nuovo thesaurus solo alla fine delle keyword presenti.

               È stata rimossa l'addDirective del "for name=", altrimenti compare un "add from thesaurus"
               in ogni field che fa riferimento alle keywords:
                   <for name="gmd:descriptiveKeywords" addDirective="data-gn-thesaurus-selector">
            -->
            <action type="add"
                    btnLabel="bnt_test"
                    name="gmd:descriptiveKeywords"
                    or="descriptiveKeywords"
                    in="/gmd:MD_Metadata/gmd:identificationInfo/*"

                    addDirective="data-gn-thesaurus-selector">
               <!--
                    allow-free-text-keywords: eliminamo il bottone per l'aggiunta di keyword libere,
                                              in quanto esiste un bottone apposto nella sezione successiva
                    data-include: 
                      - eliminamo dalla lista dei thesauri quelli già usati in questo documento
                      - Eliminiamo inoltre i thesauri aggiungibili tramite bottoni appositi nelle relative sezioni:
                         - Thesaurus nei servizi
                            - external.theme.httpinspireeceuropaeumetadatacodelistSpatialDataServiceCategory-SpatialDataServiceCategory_RNDT
                         - Thesauri nei dataset
                            - external.theme.httpinspireeceuropaeutheme-theme
                            - external.theme.httpinspireeceuropaeumetadatacodelistPriorityDataset-PriorityDataset
                            - xternal.theme.httpinspireeceuropaeumetadatacodelistSpatialScope-SpatialScope
                            - external.theme.rndt-all1
               -->
               <directiveAttributes
                  data-allow-free-text-keywords="false"
                  data-include="xpath::string-join((
                           '-external.theme.httpinspireeceuropaeutheme-theme',
                           '-external.theme.httpinspireeceuropaeumetadatacodelistPriorityDataset-PriorityDataset',
                           '-external.theme.httpinspireeceuropaeumetadatacodelistSpatialScope-SpatialScope',
                           '-external.theme.rndt-all1',
                           '-external.theme.httpinspireeceuropaeumetadatacodelistSpatialDataServiceCategory-SpatialDataServiceCategory',
                           '-external.theme.httpinspireeceuropaeumetadatacodelistSpatialDataServiceCategory-SpatialDataServiceCategory_RNDT',                           
                           '-external.theme.httpinspireeceuropaeumetadatacodelistConditionsApplyingToAccessAndUse-ConditionsApplyingToAccessAndUse',
                           '-external.place.regions',
                           '-external.theme.amministrazioni',
                           '-local.theme.amministrazioni',
                           '-external.theme.httpinspireeceuropaeumetadatacodelistProtocolValue-ProtocolValue',
                           '-external.theme.httpinspireeceuropaeumetadatacodelistLimitationsOnPublicAccess-LimitationsOnPublicAccess',
                           '-external.theme.httpinspireeceuropaeumetadatacodelistOnLineDescriptionCode-OnLineDescriptionCode',
                           '-external.theme.httpinspireeceuropaeumetadatacodelistSpatialDataServiceType-SpatialDataServiceType',
                           gmd:MD_Metadata/gmd:identificationInfo
                                          //gmd:thesaurusName/*/gmd:identifier/*/
                                            gmd:code/gmx:Anchor/
                                             concat('-', substring-after(text()[. != ''], 'geonetwork.thesaurus.'))), ',')"/>
            </action>

            <section name="freeTextKeywords">
              <!-- Keywords senza thesauri (escluso opendata) -->
              <field xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords/gmd:MD_Keywords/gmd:keyword
                           [not(../gmd:thesaurusName) 
                            and not(./gco:CharacterString='open data') 
                            and not(./gco:CharacterString='opendata')
                            and count(../gmd:keyword)>1]"
                     name="keyword_libera"
                     del="."
                     if="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords/gmd:MD_Keywords/
                       gmd:keyword[not(../gmd:thesaurusName)])>1"
              />

              <field xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords/gmd:MD_Keywords/gmd:keyword
                           [not(../gmd:thesaurusName) 
                            and not(./gco:CharacterString='open data') 
                            and not(./gco:CharacterString='opendata')
                            and count(../gmd:keyword)=1]"
                     name="keyword_libera" 
                     del="../.."
                     if="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords/gmd:MD_Keywords/
                       gmd:keyword[not(boolean(../gmd:thesaurusName))])=1"
              />

              <action type="add"
                      btnLabel="keyword_libera"
                      or="descriptiveKeywords"
                      in="gmd:MD_Metadata/gmd:identificationInfo/*"
                      if="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords/gmd:MD_Keywords/gmd:keyword[not(../gmd:thesaurusName)])=0"
              >
                <template>
                  <snippet>
                    <gmd:descriptiveKeywords>
                      <gmd:MD_Keywords>
                        <gmd:keyword>
                          <gco:CharacterString></gco:CharacterString>
                        </gmd:keyword>
                      </gmd:MD_Keywords>
                    </gmd:descriptiveKeywords>
                  </snippet>
                </template>
              </action>

              <action type="add" btnLabel="keyword_libera" or="keyword"
                      in="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords/gmd:MD_Keywords[not(gmd:thesaurusName)]"
                      if="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords/gmd:MD_Keywords/gmd:keyword[not(../gmd:thesaurusName)])>0"
              >
                <template>
                  <snippet>
                    <gmd:keyword>
                      <gco:CharacterString></gco:CharacterString>
                    </gmd:keyword>
                  </snippet>
                </template>
              </action>
            </section>

          </section>

            <field
                   xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:pointOfContact"
                   del="."
                   if="count(gmd:MD_Metadata/gmd:identificationInfo/*) > 0">
              <template>
                <values readonlyIf="count(@xlink:href) > 0">
                  <key label="organisationName"
                       xpath="gmd:CI_ResponsibleParty/gmd:organisationName/gco:CharacterString"/>
                  <key label="electronicMailAddress"
                       xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:address/gmd:CI_Address/gmd:electronicMailAddress/gco:CharacterString"
                       use="email"/>
                  <key label="phone"
                       xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:phone/gmd:CI_Telephone/gmd:voice/gco:CharacterString"/>
                  <key label="url"
                       xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:onlineResource/gmd:CI_OnlineResource/gmd:linkage/gmd:URL"/>
                  <key label="role"
                       xpath="gmd:CI_ResponsibleParty/gmd:role/gmd:CI_RoleCode/@codeListValue">
                    <codelist name="gmd:CI_RoleCode"/>
                  </key>
                </values>
                <snippet>
                  <gmd:pointOfContact>
                    <gmd:CI_ResponsibleParty>
                      <gmd:organisationName>
                        <gco:CharacterString>{{organisationName}}</gco:CharacterString>
                        <gn:copy select="gmd:PT_FreeText"/>
                      </gmd:organisationName>
                      <gmd:contactInfo>
                        <gmd:CI_Contact>
                          <gmd:phone>
                            <gmd:CI_Telephone>
                              <gmd:voice>
                                <gco:CharacterString>{{phone}}</gco:CharacterString>
                                <gn:copy select="gmd:PT_FreeText"/>
                              </gmd:voice>
                            </gmd:CI_Telephone>
                          </gmd:phone>
                          <gmd:address>
                            <gmd:CI_Address>
                              <gmd:electronicMailAddress>
                                <gco:CharacterString>{{electronicMailAddress}}</gco:CharacterString>
                                <gn:copy select="gmd:PT_FreeText"/>
                              </gmd:electronicMailAddress>
                            </gmd:CI_Address>
                          </gmd:address>
                          <gmd:onlineResource>
                            <gmd:CI_OnlineResource>
                              <gmd:linkage>
                                <gmd:URL>{{url}}</gmd:URL>
                                <gn:copy select="gmd:PT_FreeText"/>
                              </gmd:linkage>
                            </gmd:CI_OnlineResource>
                          </gmd:onlineResource>
                        </gmd:CI_Contact>
                      </gmd:contactInfo>
                      <gmd:role>
                        <gmd:CI_RoleCode
                          codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/codelist/ML_gmxCodelists.xml#CI_RoleCode"
                          codeListValue="{{role}}"/>
                      </gmd:role>
                    </gmd:CI_ResponsibleParty>
                  </gmd:pointOfContact>
                </snippet>
              </template>
            </field>


            <action type="add" btnClass="fa fa-user-plus" or="pointOfContact"
                    in="/gmd:MD_Metadata/gmd:identificationInfo/*" addDirective="data-gn-directory-entry-selector">
              <directiveAttributes
                data-template-add-action="true"
                data-search-action="true"
                data-popup-action="true"
                data-template-type="contact"
                data-insert-modes=""
                data-filter='{"_root": "gmd:CI_ResponsibleParty"}'
                data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{role}"/>
            </action>

          <section name="rndtDataConstraints">

            <field
              xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:resourceConstraints/gmd:MD_Constraints/gmd:useLimitation"
              del="../.."
            />

            <action type="add"
                    btnLabel="useLimitation"
                    or="resourceConstraints"
                    in="gmd:MD_Metadata/gmd:identificationInfo/*"
                    if="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:resourceConstraints/gmd:MD_Constraints/gmd:useLimitation) = 0">

              <template>
                <snippet>
                  <gmd:resourceConstraints>
                    <gmd:MD_Constraints>
                      <gmd:useLimitation>
                        <gco:CharacterString></gco:CharacterString>
                      </gmd:useLimitation>
                    </gmd:MD_Constraints>
                  </gmd:resourceConstraints>
                </snippet>
              </template>
            </action>

            <section name="accessConstraints">

              <field
                xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:resourceConstraints[
                gmd:MD_LegalConstraints/gmd:accessConstraints/gmd:MD_RestrictionCode/@codeListValue='otherRestrictions'
                and  contains(gmd:MD_LegalConstraints/gmd:otherConstraints/gmx:Anchor/@xlink:href, 'LimitationsOnPublicAccess')]"
                del="."
              />


              <field
                xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:resourceConstraints
                     [boolean(gmd:MD_LegalConstraints/gmd:accessConstraints) and not(gmd:MD_LegalConstraints/gmd:otherConstraints)]"
                del="."
              />

              <!--field
                     xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:resourceConstraints/gmd:MD_LegalConstraints/gmd:otherConstraints[../gmd:accessConstraints/gmd:MD_RestrictionCode/@codeListValue='otherRestrictions' and boolean(.[contains(gmx:Anchor/@xlink:href, 'LimitationsOnPublicAccess')])]"
              /-->

              <action type="add" or="resourceConstraints"
                      btnLabel="accessConstraints"
                      in="gmd:MD_Metadata/gmd:identificationInfo/*"
              >
                <template>
                  <snippet>
                    <gmd:resourceConstraints>
                      <gmd:MD_LegalConstraints>
                        <gmd:accessConstraints>
                          <gmd:MD_RestrictionCode
                            codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_RestrictionCode"
                            codeListValue="otherRestrictions">altri vincoli</gmd:MD_RestrictionCode>
                        </gmd:accessConstraints>
                        <gmd:otherConstraints>
                          <gmx:Anchor
                            xlink:href="http://inspire.ec.europa.eu/metadatacodelist/LimitationsOnPublicAccess"></gmx:Anchor>
                        </gmd:otherConstraints>
                      </gmd:MD_LegalConstraints>
                    </gmd:resourceConstraints>
                  </snippet>
                </template>
              </action>
            </section>

            <section name="useConstraints">

              <field
                xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:resourceConstraints[
                gmd:MD_LegalConstraints/*/gmd:MD_RestrictionCode/@codeListValue ='otherRestrictions']
                [not(contains(gmd:MD_LegalConstraints/gmd:otherConstraints/gmx:Anchor/@xlink:href, 'LimitationsOnPublicAccess'))
                and boolean(gmd:MD_LegalConstraints/gmd:otherConstraints/gmx:Anchor)]"
                del="."/>

              <field
                xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:resourceConstraints/gmd:MD_LegalConstraints/gmd:otherConstraints[
                ../*/gmd:MD_RestrictionCode/@codeListValue ='otherRestrictions']
                [boolean(gco:CharacterString)]"
                del="../.."/>


              <action type="add"
                      btnLabel="useConstraints"
                      or="resourceConstraints"
                      in="gmd:MD_Metadata/gmd:identificationInfo/*">
                <template>
                  <snippet label="noConditionApply">
                    <gmd:resourceConstraints>
                      <gmd:MD_LegalConstraints>
                        <gmd:useConstraints>
                          <gmd:MD_RestrictionCode
                            codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_RestrictionCode"
                            codeListValue="otherRestrictions"/>
                        </gmd:useConstraints>
                        <gmd:otherConstraints>
                          <gmx:Anchor
                            xlink:href="http://inspire.ec.europa.eu/metadata-codelist/ConditionsApplyingToAccessAndUse/noConditionsApply">Nessuna condizione applicabile</gmx:Anchor>
                        </gmd:otherConstraints>
                      </gmd:MD_LegalConstraints>
                    </gmd:resourceConstraints>
                  </snippet>
                  <snippet label="unknownCondition">
                    <gmd:resourceConstraints>
                      <gmd:MD_LegalConstraints>
                        <gmd:useConstraints>
                          <gmd:MD_RestrictionCode
                            codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_RestrictionCode"
                            codeListValue="otherRestrictions"/>
                        </gmd:useConstraints>
                        <gmd:otherConstraints>
                          <gmx:Anchor
                            xlink:href="http://inspire.ec.europa.eu/metadata-codelist/ConditionsApplyingToAccessAndUse/conditionsUnknown">Condizioni sconosciute</gmx:Anchor>
                        </gmd:otherConstraints>
                      </gmd:MD_LegalConstraints>
                    </gmd:resourceConstraints>
                  </snippet>
                  <snippet label="freeText">
                    <gmd:resourceConstraints>
                      <gmd:MD_LegalConstraints>
                        <gmd:useConstraints>
                          <gmd:MD_RestrictionCode
                            codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_RestrictionCode"
                            codeListValue="otherRestrictions"/>
                        </gmd:useConstraints>
                        <gmd:otherConstraints>
                          <gco:CharacterString></gco:CharacterString>
                        </gmd:otherConstraints>
                      </gmd:MD_LegalConstraints>
                    </gmd:resourceConstraints>
                  </snippet>
                </template>
              </action>
            </section>
          </section>

          <section name="extent">

            <section name="spatialSection">
              <field
                xpath="/gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification/
            srv:extent/gmd:EX_Extent/gmd:geographicElement/gmd:EX_GeographicBoundingBox"/>
              <field
                xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:extent/gmd:EX_Extent/gmd:geographicElement/gmd:EX_GeographicBoundingBox"
                del="."/>

              <action type="add" or="extent" btnLabel="spatialSection"
                      in="/gmd:MD_Metadata/gmd:identificationInfo/*"
                      if ="boolean(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification[not(gmd:extent/gmd:EX_Extent/gmd:geographicElement)])">
                <template>
                  <snippet>
                    <gmd:extent>
                      <gmd:EX_Extent>
                        <gmd:geographicElement>
                          <gmd:EX_GeographicBoundingBox>
                            <gmd:westBoundLongitude>
                              <gco:Decimal/>
                            </gmd:westBoundLongitude>
                            <gmd:eastBoundLongitude>
                              <gco:Decimal/>
                            </gmd:eastBoundLongitude>
                            <gmd:southBoundLatitude>
                              <gco:Decimal/>
                            </gmd:southBoundLatitude>
                            <gmd:northBoundLatitude>
                              <gco:Decimal/>
                            </gmd:northBoundLatitude>
                          </gmd:EX_GeographicBoundingBox>
                        </gmd:geographicElement>
                      </gmd:EX_Extent>
                    </gmd:extent>
                  </snippet>
                </template>
              </action>

              <action type="add" or="extent" btnLabel="spatialSection"
                      in="/gmd:MD_Metadata/gmd:identificationInfo/*"
                      if ="boolean(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification[not(srv:extent/gmd:EX_Extent/gmd:geographicElement)])">
                <template>
                  <snippet>
                    <srv:extent>
                      <gmd:EX_Extent>
                        <gmd:geographicElement>
                          <gmd:EX_GeographicBoundingBox>
                            <gmd:westBoundLongitude>
                              <gco:Decimal/>
                            </gmd:westBoundLongitude>
                            <gmd:eastBoundLongitude>
                              <gco:Decimal/>
                            </gmd:eastBoundLongitude>
                            <gmd:southBoundLatitude>
                              <gco:Decimal/>
                            </gmd:southBoundLatitude>
                            <gmd:northBoundLatitude>
                              <gco:Decimal/>
                            </gmd:northBoundLatitude>
                          </gmd:EX_GeographicBoundingBox>
                        </gmd:geographicElement>
                      </gmd:EX_Extent>
                    </srv:extent>
                  </snippet>
                </template>
              </action>

            </section>

            <section name="temporalSection">
              <field
                     xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:extent/gmd:EX_Extent/gmd:temporalElement"
                     if = "count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:extent[boolean(./gmd:EX_Extent/gmd:temporalElement)])=0"
                     del="../.."
                     />

                <field
                       xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:extent/gmd:EX_Extent/gmd:temporalElement"
                       if = "count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:extent[boolean(./gmd:EX_Extent/gmd:temporalElement)])>0"
                       del="."
                />


              <field
                xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/srv:extent/gmd:EX_Extent/gmd:temporalElement"
                if = "count(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification/srv:extent[boolean(./gmd:EX_Extent/gmd:temporalElement)])=0"
                del="../.."
              />

              <field
                xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/srv:extent/gmd:EX_Extent/gmd:temporalElement"
                if = "count(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification/srv:extent[boolean(./gmd:EX_Extent/gmd:temporalElement)])>0"
                del="."
              />

              <action type="add" name="extent" or="extent" btnLabel="temporalSection"
                      in="/gmd:MD_Metadata/gmd:identificationInfo/*"
                      if = "boolean(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification)">
                <template>
                  <snippet>
                    <gmd:extent>
                      <gmd:EX_Extent>
                        <gmd:temporalElement>
                          <gmd:EX_TemporalExtent>
                            <gmd:extent>
                              <gml:TimePeriod gml:id="">
                                <gml:beginPosition indeterminatePosition=""></gml:beginPosition>
                                <gml:endPosition indeterminatePosition=""></gml:endPosition>
                              </gml:TimePeriod>
                            </gmd:extent>
                          </gmd:EX_TemporalExtent>
                        </gmd:temporalElement>
                      </gmd:EX_Extent>
                    </gmd:extent>
                  </snippet>
                </template>
              </action>


              <action type="add" name="extent" or="extent" btnLabel="temporalSection"
                      in="/gmd:MD_Metadata/gmd:identificationInfo/*"
                      if = "boolean(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification)">
                <template>
                  <snippet>
                    <srv:extent>
                      <gmd:EX_Extent>
                        <gmd:temporalElement>
                          <gmd:EX_TemporalExtent>
                            <gmd:extent>
                              <gml:TimePeriod gml:id="">
                                <gml:beginPosition indeterminatePosition=""></gml:beginPosition>
                                <gml:endPosition indeterminatePosition=""></gml:endPosition>
                              </gml:TimePeriod>
                            </gmd:extent>
                          </gmd:EX_TemporalExtent>
                        </gmd:temporalElement>
                      </gmd:EX_Extent>
                    </srv:extent>
                  </snippet>
                </template>
              </action>
            </section>
          </section>
        </section>
      </tab>


      <tab id="datasetAndSeries" displayIfRecord="count(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification) = 0" mode="flat">

        <section name="metadataInfo">

          <field name="hierarchyLevel" xpath="/gmd:MD_Metadata/gmd:hierarchyLevel" or ="hierarchyLevel" in ="/gmd:MD_Metadata" templateModeOnly="true">
            <template>
              <values>
                <key label="hierarchyLevel" xpath="gmd:MD_ScopeCode/@codeListValue">
                  <codelist name="gmd:MD_ScopeCode"/>
                </key>
              </values>
              <snippet>
                <gmd:hierarchyLevel>
                  <gmd:MD_ScopeCode
                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_ScopeCode"
                    codeListValue="{{hierarchyLevel}}"/>
                </gmd:hierarchyLevel>
              </snippet>
            </template>
          </field>


          <action type="add" btnLabel="hierarchyLevel"
                  name="hierarchyLevel" or="hierarchyLevel"
                  in="/gmd:MD_Metadata">
            <template>
              <snippet>
                <gmd:hierarchyLevel>
                  <gmd:MD_ScopeCode
                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_ScopeCode"
                    codeListValue="dataset"/>
                </gmd:hierarchyLevel>
              </snippet>
            </template>
          </action>
        </section>

        <section name="identificationInfo">

          <field
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation/gmd:presentationForm"
            del="."
            if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0"/>

          <action type="add"
                  btnLabel="presentationForm"
                  or ="presentationForm"
                  in = "/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation"
          >
            <template>
              <snippet>
                <gmd:presentationForm>
                  <gmd:CI_PresentationFormCode
                    codeListValue="mapDigital"
                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_PresentationFormCode"/>
                </gmd:presentationForm>
              </snippet>
            </template>
          </action>

          <field
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation/gmd:series/gmd:CI_Series/gmd:issueIdentification"
            if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0"/>

          <action type="add" name="issueIdentification" or="series"
                  in="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation/gmd:series)=0">
            <template>
              <snippet>
                <gmd:series>
                  <gmd:CI_Series>
                    <gmd:issueIdentification>
                      <gco:CharacterString></gco:CharacterString>
                    </gmd:issueIdentification>
                  </gmd:CI_Series>
                </gmd:series>
              </snippet>
            </template>
          </action>

          <field
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation/gmd:otherCitationDetails"/>

          <action name="gmd:otherCitationsDetails" type="add" btnLabel="otherCitationDetails"
                  or="otherCitationDetails"
                  in="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation/gmd:otherCitationDetails)=0">

            <template>
              <snippet>
                <gmd:otherCitationDetails>
                  <gco:CharacterString></gco:CharacterString>
                </gmd:otherCitationDetails>
              </snippet>
            </template>
          </action>


          <!-- parole chiave per metadati relativi a serie/dataset:
               (3.2.4.1) INSPIRE themes
               (3.2.4.2) dataset prioritari
               (3.2.4.3) applicazioni territoriali
               (3.2.4.4) opendata
               (3.2.4.5) interesse generale
           -->
          <section name="descriptiveKeywords" >

             <section name="keyword_inspire_theme">
               <!-- <gmx:Anchor xlink:href="http://inspire.ec.europa.eu/theme">GEMET - INSPIRE themes, version 1.0</gmx:Anchor> -->

               <field xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords
                        [contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(),'GEMET - INSPIRE themes, version 1.0') ]"
                      del="." >
                   <directiveAttributes  />


               </field>

               <action type="add"
                       btnLabel="keyword_add_inspire_theme"
                       or="descriptiveKeywords"
                       in="gmd:MD_Metadata/gmd:identificationInfo/*"

                       if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification/gmd:descriptiveKeywords/
                          gmd:MD_Keywords/gmd:thesaurusName[gmd:CI_Citation/gmd:title/*/text() = 'GEMET - INSPIRE themes, version 1.0'])=0">

                 <template>
                   <snippet>

                     <gmd:descriptiveKeywords>
                       <gmd:MD_Keywords>
                         <gmd:keyword gco:nilReason="missing">
                           <gmx:Anchor xlink:href=""/>
                         </gmd:keyword>
                         <gmd:type>
                           <gmd:MD_KeywordTypeCode codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#MD_KeywordTypeCode"
                                                   codeListValue="theme">theme</gmd:MD_KeywordTypeCode>
                         </gmd:type>
                         <gmd:thesaurusName>
                           <gmd:CI_Citation>
                             <gmd:title>
                               <gco:CharacterString>GEMET - INSPIRE themes, version 1.0</gco:CharacterString>
                             </gmd:title>
                             <gmd:date>
                               <gmd:CI_Date>
                                 <gmd:date>
                                   <gco:Date>2008-06-01</gco:Date>
                                 </gmd:date>
                                 <gmd:dateType>
                                   <gmd:CI_DateTypeCode codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#CI_DateTypeCode"
                                                        codeListValue="publication">publication</gmd:CI_DateTypeCode>
                                 </gmd:dateType>
                               </gmd:CI_Date>
                             </gmd:date>
                             <gmd:identifier>
                               <gmd:MD_Identifier>
                                 <gmd:code>
                                   <gmx:Anchor xlink:href="http://localhost:8080/geonetwork/srv/it/thesaurus.download?ref=external.theme.httpinspireeceuropaeutheme-theme">geonetwork.thesaurus.external.theme.httpinspireeceuropaeutheme-theme</gmx:Anchor>
                                 </gmd:code>
                               </gmd:MD_Identifier>
                             </gmd:identifier>
                           </gmd:CI_Citation>
                         </gmd:thesaurusName>
                       </gmd:MD_Keywords>
                     </gmd:descriptiveKeywords>

                   </snippet>
                 </template>
               </action>
             </section>


             <section name="keyword_dataset_prioritari">
               <!-- <gmx:Anchor xlink:href="http://inspire.ec.europa.eu/metadata-codelist/PriorityDataset">INSPIRE priority data set</gmx:Anchor> -->
               <field xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords
                        [contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(),'INSPIRE priority data set') ]"
                      del="."/>

               <action type="add"
                       btnLabel="keyword_add_dataset_prioritari"
                       or="descriptiveKeywords"
                       in="gmd:MD_Metadata/gmd:identificationInfo/*"
                       if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification/gmd:descriptiveKeywords/
                          gmd:MD_Keywords/gmd:thesaurusName[gmd:CI_Citation/gmd:title/*/text() = 'INSPIRE priority data set'])=0">

                  <template>
                    <snippet>
                      <gmd:descriptiveKeywords>
                         <gmd:MD_Keywords>
                            <gmd:keyword gco:nilReason="missing">
                              <gmx:Anchor xlink:href=""/>
                            </gmd:keyword>
                            <gmd:type>
                               <gmd:MD_KeywordTypeCode codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#MD_KeywordTypeCode"
                                                       codeListValue="theme">theme</gmd:MD_KeywordTypeCode>
                            </gmd:type>
                            <gmd:thesaurusName>
                               <gmd:CI_Citation>
                                  <gmd:title>
                                     <gco:CharacterString>INSPIRE priority data set</gco:CharacterString>
                                  </gmd:title>
                                  <gmd:date>
                                     <gmd:CI_Date>
                                        <gmd:date>
                                           <gco:Date>2018-04-04</gco:Date>
                                        </gmd:date>
                                        <gmd:dateType>
                                           <gmd:CI_DateTypeCode codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#CI_DateTypeCode"
                                                                codeListValue="publication">publication</gmd:CI_DateTypeCode>
                                        </gmd:dateType>
                                     </gmd:CI_Date>
                                  </gmd:date>
                                  <gmd:identifier>
                                     <gmd:MD_Identifier>
                                        <gmd:code>
                                           <gmx:Anchor xlink:href="http://localhost:8080/geonetwork/srv/ita/thesaurus.download?ref=external.theme.httpinspireeceuropaeumetadatacodelistPriorityDataset-PriorityDataset">geonetwork.thesaurus.external.theme.httpinspireeceuropaeumetadatacodelistPriorityDataset-PriorityDataset</gmx:Anchor>
                                        </gmd:code>
                                     </gmd:MD_Identifier>
                                  </gmd:identifier>
                               </gmd:CI_Citation>
                            </gmd:thesaurusName>
                         </gmd:MD_Keywords>
                      </gmd:descriptiveKeywords>
                    </snippet>
                  </template>
               </action>

             </section>

             <section name="keyword_ambito_territoriale">
               <!-- <gmx:Anchor xlink:href="http://inspire.ec.europa.eu/metadata-codelist/SpatialScope">Spatial scope</gmx:Anchor> -->

               <field xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords
                        [boolean(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*
                        [contains(text(),'Spatial scope') or contains(text(),'Ambito di applicazione territoriale')])]"
                      del="."/>

               <action type="add"
                    btnLabel="keyword_add_ambito_territoriale"
                      or="descriptiveKeywords"
                      in="gmd:MD_Metadata/gmd:identificationInfo/*"

                    if="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords
                        [boolean(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*
                        [contains(text(),'Spatial scope') or contains(text(),'Ambito di applicazione territoriale')])])=0">

                  <template>
                    <snippet>
                      <gmd:descriptiveKeywords>
                         <gmd:MD_Keywords>
                            <gmd:keyword gco:nilReason="missing">
                               <gmx:Anchor xlink:href=""/>
                            </gmd:keyword>
                            <gmd:type>
                               <gmd:MD_KeywordTypeCode codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#MD_KeywordTypeCode"
                                                       codeListValue="theme">theme</gmd:MD_KeywordTypeCode>
                            </gmd:type>
                            <gmd:thesaurusName>
                               <gmd:CI_Citation>
                                  <gmd:title>
                                     <gco:CharacterString>Spatial scope</gco:CharacterString>
                                  </gmd:title>
                                  <gmd:date>
                                     <gmd:CI_Date>
                                        <gmd:date>
                                           <gco:Date>2019-05-22</gco:Date>
                                        </gmd:date>
                                        <gmd:dateType>
                                           <gmd:CI_DateTypeCode codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#CI_DateTypeCode"
                                                                codeListValue="publication">publication</gmd:CI_DateTypeCode>
                                        </gmd:dateType>
                                     </gmd:CI_Date>
                                  </gmd:date>
                                  <gmd:identifier>
                                     <gmd:MD_Identifier>
                                        <gmd:code>
                                           <gmx:Anchor xlink:href="http://localhost:8080/geonetwork/srv/ita/thesaurus.download?ref=external.theme.httpinspireeceuropaeumetadatacodelistSpatialScope-SpatialScope">geonetwork.thesaurus.external.theme.httpinspireeceuropaeumetadatacodelistSpatialScope-SpatialScope</gmx:Anchor>
                                        </gmd:code>
                                     </gmd:MD_Identifier>
                                  </gmd:identifier>
                               </gmd:CI_Citation>
                            </gmd:thesaurusName>
                         </gmd:MD_Keywords>
                      </gmd:descriptiveKeywords>
                    </snippet>
                  </template>
               </action>

             </section>


            <section name="keyword_interesse_generale" >

                <field xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords[contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(),'Registro dei dati di interesse generale per il RNDT')]"
                       del="."
                       if ="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords[contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(),'Registro dei dati di interesse generale per il RNDT')])>0"
                />

            <action type="add"
                    btnLabel="keyword_interesse_generale"
                    or="descriptiveKeywords"
                    in="gmd:MD_Metadata/gmd:identificationInfo/*"
                    if="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords/
                       gmd:MD_Keywords/gmd:thesaurusName[gmd:CI_Citation/gmd:title/*/text() = 'Registro dei dati di interesse generale per il RNDT'])=0">

              <template>
                <snippet>
                  <gmd:descriptiveKeywords>
                     <gmd:MD_Keywords>
                        <gmd:keyword gco:nilReason="missing">
                           <gmx:Anchor xlink:href=""/>
                        </gmd:keyword>
                        <gmd:type>
                           <gmd:MD_KeywordTypeCode codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#MD_KeywordTypeCode"
                                                   codeListValue="theme">theme</gmd:MD_KeywordTypeCode>
                        </gmd:type>
                        <gmd:thesaurusName>
                           <gmd:CI_Citation>
                              <gmd:title>
                                 <gco:CharacterString>Registro dei dati di interesse generale per il RNDT</gco:CharacterString>
                              </gmd:title>
                              <gmd:date>
                                 <gmd:CI_Date>
                                    <gmd:date>
                                       <gco:Date>2018-06-25</gco:Date>
                                    </gmd:date>
                                    <gmd:dateType>
                                       <gmd:CI_DateTypeCode
                                          codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#CI_DateTypeCode"
                                          codeListValue="publication">publication</gmd:CI_DateTypeCode>
                                    </gmd:dateType>
                                 </gmd:CI_Date>
                              </gmd:date>
                              <gmd:identifier>
                                 <gmd:MD_Identifier>
                                    <gmd:code>
                                       <gmx:Anchor xlink:href="http://localhost:8080/geonetwork/srv/eng/thesaurus.download?ref=external.theme.rndt-all1">geonetwork.thesaurus.external.theme.rndt-all1</gmx:Anchor>
                                    </gmd:code>
                                 </gmd:MD_Identifier>
                              </gmd:identifier>
                           </gmd:CI_Citation>
                        </gmd:thesaurusName>
                     </gmd:MD_Keywords>
                  </gmd:descriptiveKeywords>
                </snippet>
              </template>
            </action>

            </section>

            <section name="keyword_opendata" >

              <field xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords/gmd:MD_Keywords/gmd:keyword
                        [gco:CharacterString/text()='open data' or gco:CharacterString/text()='opendata']"
                     del="../.."
              />

            <action type="add"
                    btnLabel="openData"
                    or="descriptiveKeywords"
                    in="/gmd:MD_Metadata/gmd:identificationInfo/*"
                    if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification/gmd:descriptiveKeywords/gmd:MD_Keywords
                              [gmd:keyword='open data' or gmd:keyword='opendata'])=0"
            >
              <template>
                <snippet>
                  <gmd:descriptiveKeywords>
                    <gmd:MD_Keywords>
                      <gmd:keyword>
                        <gco:CharacterString>opendata</gco:CharacterString>
                      </gmd:keyword>
                    </gmd:MD_Keywords>
                  </gmd:descriptiveKeywords>
                </snippet>
              </template>
            </action>

            </section>

          </section> <!-- FINE SEZIONE KEYWORDS -->

          <field
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:characterSet"
            if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0"/>

          <action type="add"
                  btnLabel="characterSet"
                  or="characterSet"
                  in="/gmd:MD_Metadata/gmd:identificationInfo/*"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:characterSet)=0"
          >
            <template>
              <snippet>
                <gmd:characterSet>
                  <gmd:MD_CharacterSetCode
                    codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/codelist/gmxCodelists.xml#MD_CharacterSetCode"
                    codeListValue="utf8"/>
                </gmd:characterSet>
              </snippet>
            </template>
          </action>

          <field
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification/gmd:status"
            if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0"/>
          <action type="add"
                  or="status"
                  in="/gmd:MD_Metadata/gmd:identificationInfo/gmd:DataIdentification"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification/gmd:status) = 0">
            <template>
              <snippet>
                <gmd:status>
                  <gmd:ProgressCode
                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_ProgresCode"
                    codeListValue="underDevelopment">
                  </gmd:ProgressCode>
                </gmd:status>
              </snippet>
            </template>
          </action>


          <field xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:spatialRepresentationType"
                 if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0"/>

          <action type="add"
                  btnLabel="spatialRepresentationType"
                  or="spatialRepresentationType"
                  in="/gmd:MD_Metadata/gmd:identificationInfo/*"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0">
            <template>
              <snippet>
                <gmd:spatialRepresentationType>
                  <gmd:MD_SpatialRepresentationTypeCode
                    codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/codelist/gmxCodelists.xml#MD_SpatialRepresentationTypeCode"
                    codeListValue="vector"/>
                </gmd:spatialRepresentationType>
              </snippet>
            </template>
          </action>


          <field name="spatialResolutionScale"
                 xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:spatialResolution/gmd:MD_Resolution/gmd:equivalentScale/gmd:MD_RepresentativeFraction/gmd:denominator"
                 del="../../../.."
                 if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0"
          />

          <field name="spatialResolution"
                 xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:spatialResolution/gmd:MD_Resolution/gmd:distance"
                 del="../.."
                 if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0"/>

          <action type="add" btnLabel="spatialResolution" or="spatialResolution"
                  in="/gmd:MD_Metadata/gmd:identificationInfo/*"
          >
            <template>
              <snippet label="spatialResolutionScale">
                <gmd:spatialResolution>
                  <gmd:MD_Resolution>
                    <gmd:equivalentScale>
                      <gmd:MD_RepresentativeFraction>
                        <gmd:denominator>
                          <gco:Integer/>
                        </gmd:denominator>
                      </gmd:MD_RepresentativeFraction>
                    </gmd:equivalentScale>
                  </gmd:MD_Resolution>
                </gmd:spatialResolution>
              </snippet>
              <snippet label="spatialResolutionDistance">
                <gmd:spatialResolution>
                  <gmd:MD_Resolution>
                    <gmd:distance>
                      <gco:Distance uom="http://standards.iso.org/iso/19139/resources/uom/ML_gmxUom.xml#m"/>
                    </gmd:distance>
                  </gmd:MD_Resolution>
                </gmd:spatialResolution>
              </snippet>
            </template>
          </action>

          <field name="language"
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:language/gmd:LanguageCode" del="..">
          </field>
          <action type="add" btnLabel="language"
                  name="language" or="language"
                  in="/gmd:MD_Metadata/gmd:identificationInfo/*">
            <template>
              <snippet>
                <gmd:language>
                  <gmd:LanguageCode codeList="http://www.loc.gov/standards/iso639-2/" codeListValue="ita"/>
                </gmd:language>
              </snippet>
            </template>
          </action>


          <section name="topicCategory">
          <field
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:topicCategory"
            if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0"/>
          <action type="add"
                  btnLabel="addTopic"
                  name="topicCategory" or="topicCategory"
                  in="/gmd:MD_Metadata/gmd:identificationInfo/*"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0">
            <template>
              <snippet>
                <gmd:topicCategory>
                  <gmd:MD_TopicCategoryCode></gmd:MD_TopicCategoryCode>
                </gmd:topicCategory>
              </snippet>
            </template>
          </action>
          </section>

          <field
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification/gmd:supplementalInformation"
            or="supplementalInformation"
            in="/gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification"
            del="."
          />

          <action type="add" btnLabel="supplementalInformation"  or="supplementalInformation"  in="/gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification/gmd:supplementalInformation)=0">
            <template>
              <snippet>
                <gmd:supplementalInformation>
                  <gco:CharacterString/>
                </gmd:supplementalInformation>
              </snippet>
            </template>
          </action>

          <section name="extent">

            <section name="verticalSection" displayIfRecord="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0">
              <field name="verticalExtension" templateModeOnly="true" notDisplayedIfMissing="true"
                     xpath="/gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification/gmd:extent/gmd:EX_Extent/gmd:verticalElement"
                     if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0">
                <template>
                  <values>
                    <key label="minimumValue"
                         xpath="gmd:EX_VerticalExtent/gmd:minimumValue/gco:Real/number()"/>

                    <key label="maximumValue"
                         xpath="gmd:EX_VerticalExtent/gmd:maximumValue/gco:Real/number()"/>
                    <key label="verticalCRS"
                         xpath="gmd:EX_VerticalExtent/gmd:verticalCRS/@xlink:href"/>

                  </values>
                  <snippet>
                    <gmd:verticalElement>
                      <gmd:EX_VerticalExtent>
                        <gmd:minimumValue>
                          <gco:Real>
                            {{minimumValue}}
                          </gco:Real>
                        </gmd:minimumValue>
                        <gmd:maximumValue>
                          <gco:Real>
                            {{maximumValue}}
                          </gco:Real>
                        </gmd:maximumValue>
                        <gmd:verticalCRS xlink:href="{{verticalCRS}}"/>
                      </gmd:EX_VerticalExtent>
                    </gmd:verticalElement>
                  </snippet>
                </template>
              </field>

              <action type="add" name="extent" or="extent" btnLabel="verticalSection"
                      in="/gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification"
                      if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification/gmd:extent/gmd:EX_Extent/gmd:verticalElement) = 0">
                <template>
                  <snippet label="ETRS89-XYZ">
                    <gmd:extent>
                      <gmd:EX_Extent>
                        <gmd:verticalElement>
                          <gmd:EX_VerticalExtent>
                            <gmd:minimumValue>
                              <gco:Real></gco:Real>
                            </gmd:minimumValue>
                            <gmd:maximumValue>
                              <gco:Real></gco:Real>
                            </gmd:maximumValue>
                            <gmd:verticalCRS xlink:href="http://www.opengis.net/def/crs/EPSG/0/4936"/>
                          </gmd:EX_VerticalExtent>
                        </gmd:verticalElement>
                      </gmd:EX_Extent>
                    </gmd:extent>
                  </snippet>
                  <snippet label="ETRS89-GRS80h">
                    <gmd:extent>
                      <gmd:EX_Extent>
                        <gmd:verticalElement>
                          <gmd:EX_VerticalExtent>
                            <gmd:minimumValue>
                              <gco:Real></gco:Real>
                            </gmd:minimumValue>
                            <gmd:maximumValue>
                              <gco:Real></gco:Real>
                            </gmd:maximumValue>
                            <gmd:verticalCRS xlink:href="http://www.opengis.net/def/crs/EPSG/0/4937"/>
                          </gmd:EX_VerticalExtent>
                        </gmd:verticalElement>
                      </gmd:EX_Extent>
                    </gmd:extent>
                  </snippet>
                  <snippet label="RDN2008-6704">
                    <gmd:extent>
                      <gmd:EX_Extent>
                        <gmd:verticalElement>
                          <gmd:EX_VerticalExtent>
                            <gmd:minimumValue>
                              <gco:Real></gco:Real>
                            </gmd:minimumValue>
                            <gmd:maximumValue>
                              <gco:Real></gco:Real>
                            </gmd:maximumValue>
                            <gmd:verticalCRS xlink:href="http://www.opengis.net/def/crs/EPSG/0/6704"/>
                          </gmd:EX_VerticalExtent>
                        </gmd:verticalElement>
                      </gmd:EX_Extent>
                    </gmd:extent>
                  </snippet>
                  <snippet label="RDN2008-6705">
                    <gmd:extent>
                      <gmd:EX_Extent>
                        <gmd:verticalElement>
                          <gmd:EX_VerticalExtent>
                            <gmd:minimumValue>
                              <gco:Real></gco:Real>
                            </gmd:minimumValue>
                            <gmd:maximumValue>
                              <gco:Real></gco:Real>
                            </gmd:maximumValue>
                            <gmd:verticalCRS xlink:href="http://www.opengis.net/def/crs/EPSG/0/6705"/>
                          </gmd:EX_VerticalExtent>
                        </gmd:verticalElement>
                      </gmd:EX_Extent>
                    </gmd:extent>
                  </snippet>
                  <snippet label="EVRS">
                    <gmd:extent>
                      <gmd:EX_Extent>
                        <gmd:verticalElement>
                          <gmd:EX_VerticalExtent>
                            <gmd:minimumValue>
                              <gco:Real></gco:Real>
                            </gmd:minimumValue>
                            <gmd:maximumValue>
                              <gco:Real></gco:Real>
                            </gmd:maximumValue>
                            <gmd:verticalCRS xlink:href="http://www.opengis.net/def/crs/EPSG/0/5730"/>
                          </gmd:EX_VerticalExtent>
                        </gmd:verticalElement>
                      </gmd:EX_Extent>
                    </gmd:extent>
                  </snippet>
                  <snippet label="LAT">
                    <gmd:extent>
                      <gmd:EX_Extent>
                        <gmd:verticalElement>
                          <gmd:EX_VerticalExtent>
                            <gmd:minimumValue>
                              <gco:Real></gco:Real>
                            </gmd:minimumValue>
                            <gmd:maximumValue>
                              <gco:Real></gco:Real>
                            </gmd:maximumValue>
                            <gmd:verticalCRS xlink:href="http://www.opengis.net/def/crs/EPSG/0/5861"/>
                          </gmd:EX_VerticalExtent>
                        </gmd:verticalElement>
                      </gmd:EX_Extent>
                    </gmd:extent>
                  </snippet>
                  <snippet label="MSL">
                    <gmd:extent>
                      <gmd:EX_Extent>
                        <gmd:verticalElement>
                          <gmd:EX_VerticalExtent>
                            <gmd:minimumValue>
                              <gco:Real></gco:Real>
                            </gmd:minimumValue>
                            <gmd:maximumValue>
                              <gco:Real></gco:Real>
                            </gmd:maximumValue>
                            <gmd:verticalCRS xlink:href="http://www.opengis.net/def/crs/EPSG/0/5715"/>
                          </gmd:EX_VerticalExtent>
                        </gmd:verticalElement>
                      </gmd:EX_Extent>
                    </gmd:extent>
                  </snippet>
                  <snippet label="ISA">
                    <gmd:extent>
                      <gmd:EX_Extent>
                        <gmd:verticalElement>
                          <gmd:EX_VerticalExtent>
                            <gmd:minimumValue>
                              <gco:Real></gco:Real>
                            </gmd:minimumValue>
                            <gmd:maximumValue>
                              <gco:Real></gco:Real>
                            </gmd:maximumValue>
                            <gmd:verticalCRS xlink:href="http://codes.wmo.int/grib2/codeflag/4.2/_0-3-3"/>
                          </gmd:EX_VerticalExtent>
                        </gmd:verticalElement>
                      </gmd:EX_Extent>
                    </gmd:extent>
                  </snippet>
                  <snippet label="ETRS89-GRS80-EVRS">
                    <gmd:extent>
                      <gmd:EX_Extent>
                        <gmd:verticalElement>
                          <gmd:EX_VerticalExtent>
                            <gmd:minimumValue>
                              <gco:Real></gco:Real>
                            </gmd:minimumValue>
                            <gmd:maximumValue>
                              <gco:Real></gco:Real>
                            </gmd:maximumValue>
                            <gmd:verticalCRS xlink:href="http://www.opengis.net/def/crs/EPSG/0/7409"/>
                          </gmd:EX_VerticalExtent>
                        </gmd:verticalElement>
                      </gmd:EX_Extent>
                    </gmd:extent>
                  </snippet>
                </template>
              </action>
            </section>
          </section>
        </section>

        <section name="dataQualityInfo">

          <field xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:scope/gmd:DQ_Scope/gmd:level"/>

          <action type="add" or="scope"
                  in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                  if="count(/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:scope)=0">
            <template>
            <snippet label="dataset">
              <gmd:scope>
                <gmd:DQ_Scope>
                  <gmd:level>
                    <gmd:MD_ScopeCode
                      codeListValue="dataset"
                      codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_ScopeCode">
                      dataset
                    </gmd:MD_ScopeCode>
                  </gmd:level>
                </gmd:DQ_Scope>
              </gmd:scope>
            </snippet>
              <snippet label="series">
                <gmd:scope>
                  <gmd:DQ_Scope>
                    <gmd:level>
                      <gmd:MD_ScopeCode
                        codeListValue="series"
                        codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_ScopeCode">
                        series
                      </gmd:MD_ScopeCode>
                    </gmd:level>
                  </gmd:DQ_Scope>
                </gmd:scope>
              </snippet>
            </template>
          </action>

          <!--section name="positionalAccuracy" displayIfRecord="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0">
            <field xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/
  gmd:report/gmd:DQ_AbsoluteExternalPositionalAccuracy/gmd:result/gmd:DQ_QuantitativeResult/gmd:valueUnit"
            /-->

          <section name="positionalAccuracy">
            <field xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/
            gmd:report/gmd:DQ_AbsoluteExternalPositionalAccuracy/gmd:result/gmd:DQ_QuantitativeResult/gmd:value/gco:Record"
            />
            <action type="add"
                    btnLabel="positionalAccuracy"
                    or="report"
                    in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                    if="count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_AbsoluteExternalPositionalAccuracy/gmd:result)=0">
              <template>
                <snippet>
                  <gmd:report>
                    <gmd:DQ_AbsoluteExternalPositionalAccuracy>
                      <gmd:result>
                        <gmd:DQ_QuantitativeResult>
                          <gmd:valueUnit>
                            <gml:BaseUnit gml:id="m">
                              <gml:identifier
                                codeSpace="http://www.bipm.org/en/si/base_units">m</gml:identifier>
                              <gml:unitsSystem
                                xlink:href="http://www.bipm.org/en/si"/>
                            </gml:BaseUnit>
                          </gmd:valueUnit>
                          <gmd:value>
                            <gco:Record>
                              <gco:Real>0.0</gco:Real>
                            </gco:Record>
                          </gmd:value>
                        </gmd:DQ_QuantitativeResult>
                      </gmd:result>
                    </gmd:DQ_AbsoluteExternalPositionalAccuracy>
                  </gmd:report>
                </snippet>
              </template>
            </action>
          </section>

          <section name="topologicalConsistency">

            <field templateModeOnly="true" notDisplayedIfMissing="true" name="topologicalConsistency"
                   xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_TopologicalConsistency" del="..">
              <template>
                <values>
                  <key label="nameOfMeasure"
                       xpath="gmd:nameOfMeasure/gco:CharacterString">
                    <helper name="gmd:nameOfMeasure" context="gmd:DQ_TopologicalConsistency"/>
                  </key>
                  <key label="evaluationMethodType"
                       xpath="gmd:evaluationMethodType/gmd:DQ_EvaluationMethodTypeCode"
                  />
                  <key label="evaluationMethodDescr"
                       xpath="gmd:evaluationMethodDescription/gco:CharacterString"
                  />
                  <key label="dateTime"
                       xpath="gmd:dateTime/gco:DateTime"
                       use="gn-date-picker">
                    <directiveAttributes data-tag-name="gco:DateTime"/>
                  </key>
                  <key label="valueUnit"
                       xpath="gmd:result/gmd:DQ_QuantitativeResult/gmd:valueUnit/@xlink:href"
                  />
                  <key label="topologicalRecord"
                       xpath="gmd:result/gmd:DQ_QuantitativeResult/gmd:value/gco:Record"
                       use="number"
                  />
                </values>
                <snippet>
                  <gmd:DQ_TopologicalConsistency>
                    <gmd:nameOfMeasure>
                      <gco:CharacterString>{{nameOfMeasure}}</gco:CharacterString>
                    </gmd:nameOfMeasure>
                    <gmd:evaluationMethodType>
                      {{evaluationMethodType}}
                    </gmd:evaluationMethodType>
                    <gmd:evaluationMethodDescription>
                      <gco:CharacterString>{{evaluationMethodDescr}}</gco:CharacterString>
                    </gmd:evaluationMethodDescription>
                    <gmd:dateTime>
                      {{dateTime}}
                    </gmd:dateTime>
                    <gmd:result>
                      <gmd:DQ_QuantitativeResult>
                        <gmd:valueUnit
                          xlink:href="{{valueUnit}}"/>
                        <gmd:value>
                          <gco:Record xmlns:xs="http://www.w3.org/2001/XMLSchema"
                                      xsi:type="xs:integer">{{topologicalRecord}}</gco:Record>
                        </gmd:value>
                      </gmd:DQ_QuantitativeResult>
                    </gmd:result>
                  </gmd:DQ_TopologicalConsistency>
                </snippet>
              </template>
            </field>

            <action type ="add" or ="report" btnLabel="topologicalConsistency"
                    in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                    if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0">
              <template>
                <snippet>
                  <gmd:report>
                    <gmd:DQ_TopologicalConsistency>
                      <gmd:nameOfMeasure>
                        <gco:CharacterString/>
                      </gmd:nameOfMeasure>
                      <gmd:evaluationMethodType>
                        <gmd:DQ_EvaluationMethodTypeCode
                          codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#DQ_EvaluationMethodTypeCode"
                          codeListValue="indirect"/>
                      </gmd:evaluationMethodType>
                      <gmd:evaluationMethodDescription>
                        <gco:CharacterString/>
                      </gmd:evaluationMethodDescription>
                      <gmd:dateTime>
                        <gco:DateTime></gco:DateTime>
                      </gmd:dateTime>
                      <gmd:result>
                        <gmd:DQ_QuantitativeResult>
                          <gmd:valueUnit
                            xlink:href="http://www.opengis.net/def/uom/OGC/1.0/unity"/>
                          <gmd:value>
                            <gco:Record xmlns:xs="http://www.w3.org/2001/XMLSchema"
                                        xsi:type="xs:integer"/>
                          </gmd:value>
                        </gmd:DQ_QuantitativeResult>
                      </gmd:result>
                    </gmd:DQ_TopologicalConsistency>
                  </gmd:report>
                </snippet>
              </template>
            </action>
          </section>

          <section name="lineage">
          <field
                 xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:lineage/gmd:LI_Lineage/gmd:statement"/>
          <action type="add" name="lineage" or="statement" btnLabel="lineage"
                  in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:lineage/gmd:LI_Lineage">
            <template>
              <snippet>
                <gmd:statement>
                  <gco:CharacterString></gco:CharacterString>
                </gmd:statement>
              </snippet>
            </template>
          </action>
          <action type="add" name="lineage" or="lineage" btnLabel="lineage"
                  in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality">
            <template>
              <snippet>
                <gmd:lineage>
                  <gmd:LI_Lineage>
                    <gmd:statement>
                      <gco:CharacterString></gco:CharacterString>
                    </gmd:statement>
                  </gmd:LI_Lineage>
                </gmd:lineage>
              </snippet>
            </template>
          </action>
          </section>

          <section name="conformitySpecifications">

            <field templateModeOnly="true"
                   xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/
                    gmd:report/gmd:DQ_DomainConsistency/gmd:result"
                   if="count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/
                      gmd:report/gmd:DQ_DomainConsistency/gmd:result/gmd:DQ_ConformanceResult/gmd:specification/
                      gmd:CI_Citation/gmd:title/gmx:Anchor) > 0"
                   del="../..">
              <template>
                <values>
                  <key label="conformity_desc"
                       xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/text()"
                       tooltip="gmd:pass">
                  </key>
                  <key label="conformity_linkage"
                       xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/@xlink:href">
                  </key>
                  <key label="conformity_date"
                       xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:date/gmd:CI_Date/gmd:date/gco:Date"
                       use="gn-date-picker">
                    <directiveAttributes
                      data-tag-name="gco:Date"
                      />
                  </key>
                  <key label="pass"
                       xpath="gmd:DQ_ConformanceResult/gmd:pass/gco:Boolean"
                       use="gn-checkbox-with-nilreason">
                    <directiveAttributes
                      data-tag-name="gmd:pass"
                      data-nilreason="eval#gmd:DQ_ConformanceResult/gmd:pass/@gco:nilReason"
                      data-labels='{"true": "conformant", "false": "notConformant", "unknown": "notEvaluated"}'/>
                  </key>
                </values>
                <snippet>
                  <gmd:result>
                    <gmd:DQ_ConformanceResult>
                      <gmd:specification>
                        <gmd:CI_Citation>
                          <gmd:title>
                            <gmx:Anchor xlink:href="{{conformity_linkage}}">{{conformity_desc}}</gmx:Anchor>
                          </gmd:title>
                          <gmd:date>
                            <gmd:CI_Date>
                              <gmd:date>
                                {{conformity_date}}
                              </gmd:date>
                              <gmd:dateType>
                                <gmd:CI_DateTypeCode
                                  codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                  codeListValue="publication"/>
                              </gmd:dateType>
                            </gmd:CI_Date>
                          </gmd:date>
                        </gmd:CI_Citation>
                      </gmd:specification>
                      <gn:copy select="gmd:explanation"/>
                        {{pass}}
                    </gmd:DQ_ConformanceResult>
                  </gmd:result>
                </snippet>
              </template>
            </field>

            <field templateModeOnly="true"
                   xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/
                    gmd:report/gmd:DQ_DomainConsistency/gmd:result"
                   if="count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_DomainConsistency/
                   gmd:result/gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gco:CharacterString) > 0"
                   del="../..">
              <template>
                <values>
                  <key label="conformity_title"
                       xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gco:CharacterString"
                       >
                  </key>
                  <key label="conformity_date"
                       xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:date/gmd:CI_Date/gmd:date/gco:Date"
                       use="gn-date-picker">
                    <directiveAttributes data-tag-name="gco:Date"/>
                  </key>
                  <key label="pass"
                       xpath="gmd:DQ_ConformanceResult/gmd:pass/gco:Boolean"
                       use="gn-checkbox-with-nilreason">
                    <directiveAttributes
                      data-tag-name="gmd:pass"
                      data-nilreason="eval#gmd:DQ_ConformanceResult/gmd:pass/@gco:nilReason"
                      data-labels='{"true": "conformant", "false": "notConformant", "unknown": "notEvaluated"}'/>
                  </key>
                </values>
                <snippet>
                  <gmd:result>
                    <gmd:DQ_ConformanceResult>
                      <gmd:specification>
                        <gmd:CI_Citation>
                          <gmd:title>
                            <gco:CharacterString>{{conformity_title}}</gco:CharacterString>
                          </gmd:title>
                          <gmd:date>
                            <gmd:CI_Date>
                              <gmd:date>
                                {{conformity_date}}
                              </gmd:date>
                              <gmd:dateType>
                                <gmd:CI_DateTypeCode
                                  codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                  codeListValue="publication"/>
                              </gmd:dateType>
                            </gmd:CI_Date>
                          </gmd:date>
                        </gmd:CI_Citation>
                      </gmd:specification>
                      <gn:copy select="gmd:explanation"/>
                        {{pass}}
                    </gmd:DQ_ConformanceResult>
                  </gmd:result>
                </snippet>
              </template>
            </field>


            <action type="add" or="report"
                    btnLabel="conformitySpecifications"
                    in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                    if="count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_DomainConsistency/gmd:result/gmd:DQ_ConformanceResult)=0">
              <template>
                <snippet>
                  <gmd:report>
                    <gmd:DQ_DomainConsistency>
                      <gmd:result>
                        <gmd:DQ_ConformanceResult>
                          <gmd:specification>
                            <gmd:CI_Citation>
                              <gmd:title>
                                <gmx:Anchor
                                    xlink:href="http://data.europa.eu/eli/reg/2010/1089">REGOLAMENTO (UE) N. 1089/2010 DELLA COMMISSIONE del 23 novembre 2010 recante attuazione della direttiva 2007/2/CE del Parlamento europeo e del Consiglio per quanto riguarda l'interoperabilità dei set di dati territoriali e dei servizi di dati territoriali</gmx:Anchor>
                              </gmd:title>
                              <gmd:date>
                                <gmd:CI_Date>
                                  <gmd:date>
                                    <gco:Date>2010-12-08</gco:Date>
                                  </gmd:date>
                                  <gmd:dateType>
                                    <gmd:CI_DateTypeCode
                                      codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                      codeListValue="publication">pubblicazione</gmd:CI_DateTypeCode>
                                  </gmd:dateType>
                                </gmd:CI_Date>
                              </gmd:date>
                            </gmd:CI_Citation>
                          </gmd:specification>
                          <gmd:explanation>
                            <gco:CharacterString>Fare riferimento alle specifiche indicate</gco:CharacterString>
                          </gmd:explanation>
                          <gmd:pass gco:nilReason="">
                            <gco:Boolean>true</gco:Boolean>
                          </gmd:pass>
                        </gmd:DQ_ConformanceResult>
                      </gmd:result>
                    </gmd:DQ_DomainConsistency>
                  </gmd:report>
                </snippet>
              </template>
            </action>
          </section>
        </section>

        <section name="referenceSystems">

            <field 
                  name="rsFieldAnchor"
                  templateModeOnly="true"                
                  xpath="/gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier[boolean(gmd:RS_Identifier/gmd:code/gmx:Anchor)]"
                  if="count(gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier[boolean(gmd:RS_Identifier/gmd:code/gmx:Anchor)]) > 0"
                  del="../..">
              <template>
                <values>
                  <key label="rsCode"
                       xpath="gmd:RS_Identifier/gmd:code/gmx:Anchor"
                       tooltip="gmd:referenceSystemInfo"/>
                  <key label="rsLink"
                       xpath="gmd:RS_Identifier/gmd:code/gmx:Anchor/@xlink:href"/>
                </values>
                <snippet>
                  <gmd:referenceSystemIdentifier>
                    <gmd:RS_Identifier>
                      <gmd:code>
                        <gmx:Anchor xlink:href="{{rsLink}}">{{rsCode}}</gmx:Anchor>
                      </gmd:code>
                    </gmd:RS_Identifier>
                  </gmd:referenceSystemIdentifier>
                </snippet>
              </template>
            </field>

            <field 
              name="rsFieldCCS"
              templateModeOnly="true"
              xpath="/gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier[gmd:RS_Identifier/gmd:code/gco:CharacterString and gmd:RS_Identifier/gmd:codeSpace]"
              if="count(gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier[gmd:RS_Identifier/gmd:code/gco:CharacterString and gmd:RS_Identifier/gmd:codeSpace]) > 0"
              del="../..">
              <template>
                <values>
                  <key label="rsCode"
                       xpath="gmd:RS_Identifier/gmd:code/gco:CharacterString"
                       tooltip="gmd:referenceSystemInfo"/>
                  <key label="rsCodeSpace" 
                       xpath="gmd:RS_Identifier/gmd:codeSpace/gco:CharacterString"/>
                </values>
                <snippet>
                  <gmd:referenceSystemIdentifier>
                    <gmd:RS_Identifier>
                      <gmd:code>
                        <gco:CharacterString>{{rsCode}}</gco:CharacterString>
                      </gmd:code>
                      <gmd:codeSpace>
                        <gco:CharacterString>{{rsCodeSpace}}</gco:CharacterString>
                      </gmd:codeSpace>
                    </gmd:RS_Identifier>
                  </gmd:referenceSystemIdentifier>
                </snippet>
              </template>
            </field>

            <field
              name="rsFieldCode"
              templateModeOnly="true"            
              xpath="/gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier[gmd:RS_Identifier/gmd:code/gco:CharacterString and not(gmd:RS_Identifier/gmd:codeSpace)]"
              if="count(gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier[gmd:RS_Identifier/gmd:code/gco:CharacterString and not(gmd:RS_Identifier/gmd:codeSpace)]) > 0"
              del="../..">
              <template>
                <values>
                  <key label="rsCode"
                       xpath="gmd:RS_Identifier/gmd:code/gco:CharacterString"
                       tooltip="gmd:referenceSystemInfo"/>
                </values>
                <snippet>
                  <gmd:referenceSystemIdentifier>
                    <gmd:RS_Identifier>
                      <gmd:code>
                          <gco:CharacterString>{{rsCode}}</gco:CharacterString>
                      </gmd:code>
                    </gmd:RS_Identifier>
                  </gmd:referenceSystemIdentifier>
                </snippet>
              </template>
            </field>


            <action type="add"
                    btnLabel="addRsRNDT"
                    or="referenceSystemInfo"
                    in="/gmd:MD_Metadata"
                    if="count(gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier/gmd:RS_Identifier/gmd:code[contains(.,'RDN') or starts-with(.,'ED50')
                    or contains(.,'Monte-Mario') or contains(.,'ETRS') or contains(.,'ITRS') or contains(.,'WGS') or contains(.,'EPSG')])=0"
            >
              <template>
                <snippet label="EPSG4936">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4936">ETRS89-XYZ</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG4937">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4937">ETRS89-GRS80</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG4258">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4258">ETRS89-GRS80</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG3035">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/3035">ETRS89-LAEA</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG3034">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/3034">ETRS89-LCC</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG25832">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/25832">ETRS89-UTM32N</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG25833">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/25833">ETRS89-UTM33N</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG25834">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/25834">ETRS89-UTM34N</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG6704">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor  xlink:href="http://www.opengis.net/def/crs/EPSG/0/6704">RDN2008-6704</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG6705">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6705">RDN2008-6705</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG6706">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6706">RDN2008-6706</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG6707">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6707">RDN2008-TM32NE</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG7791">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/9.6.1/7791">RDN2008-TM32EN</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG6708">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6708">RDN2008-TM33NE</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG7792">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code >
                            <gmx:Anchor  xlink:href="http://www.opengis.net/def/crs/EPSG/9.6.1/7792">RDN2008-TM33EN</gmx:Anchor>
                          </gmd:code >
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG6709">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6709">RDN2008-TM34NE</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG7793">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor  xlink:href="http://www.opengis.net/def/crs/EPSG/9.6.1/7793">RDN2008-TM34EN</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG6875">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6875">RDN2008-ItalyNE</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG7794">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/9.6.1/7794">RDN2008-ItalyEN</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG6876">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6876">RDN2008-12NE</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG7795">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/9.6.1/7795">RDN2008-12EN</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG4230">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4230">ED50</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG23032">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/23032">ED50-UTM32N</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG23033">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/23033">ED50-UTM33N</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG23034">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/23034">ED50-UTM34N</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG4806">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4806">Monte-Mario-Rome</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG4265">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4265">Monte-Mario</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG3003">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/3003">Monte-Mario-Italy1</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="EPSG3004">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/3004">Monte-Mario-Italy2</gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
              </template>
            </action>

            <action type="add"
                    btnLabel="referenceSystem"
                    or="referenceSystemInfo"
                    in="gmd:MD_Metadata">
              <template>
                <snippet label="addRsAnchor">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gmx:Anchor xlink:href=""></gmx:Anchor>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="addRsCode">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gco:CharacterString></gco:CharacterString>
                          </gmd:code>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>
                <snippet label="addRsCCS">
                  <gmd:referenceSystemInfo>
                    <gmd:MD_ReferenceSystem>
                      <gmd:referenceSystemIdentifier>
                        <gmd:RS_Identifier>
                          <gmd:code>
                            <gco:CharacterString></gco:CharacterString>
                          </gmd:code>
                          <gmd:codeSpace>
                            <gco:CharacterString></gco:CharacterString>
                          </gmd:codeSpace>
                        </gmd:RS_Identifier>
                      </gmd:referenceSystemIdentifier>
                    </gmd:MD_ReferenceSystem>
                  </gmd:referenceSystemInfo>
                </snippet>

              </template>
            </action>

        </section>

        <section name="dataDistribution" displayIfRecord="count(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification) = 0">
          <field name="gmd:distributionFormat" templateModeOnly="true" notDisplayedIfMissing="true"
                 xpath="/gmd:MD_Metadata/gmd:distributionInfo/gmd:MD_Distribution/gmd:distributionFormat"
                 del=".">
            <template>
              <values>
                <key label="format"
                     xpath="gmd:MD_Format/gmd:name/gco:CharacterString">
                  <helper name="gmd:name" context="gmd:MD_Format"/>
                </key>
                <key label="format_version" xpath="gmd:MD_Format/gmd:version/gco:CharacterString"/>
              </values>
              <snippet>
                <gmd:distributionFormat>
                  <gmd:MD_Format>
                    <gmd:name>
                      <gco:CharacterString>{{format}}</gco:CharacterString>
                      <gn:copy select="gmd:PT_FreeText"/>
                    </gmd:name>
                    <gmd:version gco:nilReason="">
                      <gco:CharacterString>{{format_version}}</gco:CharacterString>
                    </gmd:version>
                    <gn:copy select="gmd:amendmentNumber"/>
                    <gn:copy select="gmd:specification"/>
                    <gn:copy select="gmd:fileDecompressionTechnique"/>
                    <gn:copy select="gmd:formatDistributor"/>
                  </gmd:MD_Format>
                </gmd:distributionFormat>
              </snippet>
            </template>

          </field>

          <action type="add" name="gmd:distributionFormat" or="distributionFormat" btnLabel="distributionFormat"
                  in="/gmd:MD_Metadata/gmd:distributionInfo/gmd:MD_Distribution"
          >
            <template>
              <snippet>
                <gmd:distributionFormat>
                  <gmd:MD_Format>
                    <gmd:name>
                      <gmx:Anchor xlink:href=""></gmx:Anchor>
                    </gmd:name>
                    <gmd:version gco:nilReason="unknown">
                      <gco:CharacterString/>
                    </gmd:version>
                  </gmd:MD_Format>
                </gmd:distributionFormat>
              </snippet>
            </template>
          </action>

          <field
            xpath="/gmd:MD_Metadata/gmd:distributionInfo/gmd:MD_Distribution/gmd:distributor/gmd:MD_Distributor/gmd:distributorContact"
            del="../..">
            <template>
              <values readonlyIf="count(@xlink:href) > 0">
                <key label="organisationName"
                     xpath="gmd:CI_ResponsibleParty/gmd:organisationName/gco:CharacterString"/>
                <key label="electronicMailAddress"
                     xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:address/gmd:CI_Address/gmd:electronicMailAddress/gco:CharacterString"
                     use="email"/>
                <key label="phone"
                     xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:phone/gmd:CI_Telephone/gmd:voice/gco:CharacterString"/>
                <key label="url"
                     xpath="gmd:CI_ResponsibleParty/gmd:contactInfo/
                                  gmd:CI_Contact/gmd:onlineResource/gmd:CI_OnlineResource/gmd:linkage/gmd:URL"/>
                <key label="role"
                     xpath="gmd:CI_ResponsibleParty/gmd:role/gmd:CI_RoleCode/@codeListValue">
                  <codelist name="gmd:CI_RoleCode"/>
                </key>
              </values>
              <snippet>
                <gmd:distributorContact>
                  <gmd:CI_ResponsibleParty>
                    <gmd:organisationName>
                      <gco:CharacterString>{{organisationName}}</gco:CharacterString>
                      <gn:copy select="gmd:PT_FreeText"/>
                    </gmd:organisationName>
                    <gmd:contactInfo>
                      <gmd:CI_Contact>
                        <gmd:phone>
                          <gmd:CI_Telephone>
                            <gmd:voice>
                              <gco:CharacterString>{{phone}}</gco:CharacterString>
                              <gn:copy select="gmd:PT_FreeText"/>
                            </gmd:voice>
                          </gmd:CI_Telephone>
                        </gmd:phone>
                        <gmd:address>
                          <gmd:CI_Address>
                            <gmd:electronicMailAddress>
                              <gco:CharacterString>{{electronicMailAddress}}</gco:CharacterString>
                              <gn:copy select="gmd:PT_FreeText"/>
                            </gmd:electronicMailAddress>
                          </gmd:CI_Address>
                        </gmd:address>
                        <gmd:onlineResource>
                          <gmd:CI_OnlineResource>
                            <gmd:linkage>
                              <gmd:URL>{{url}}</gmd:URL>
                              <gn:copy select="gmd:PT_FreeText"/>
                            </gmd:linkage>
                          </gmd:CI_OnlineResource>
                        </gmd:onlineResource>
                      </gmd:CI_Contact>
                    </gmd:contactInfo>
                    <gmd:role>
                      <gmd:CI_RoleCode
                        codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/codelist/ML_gmxCodelists.xml#CI_RoleCode"
                        codeListValue="{{role}}"/>
                    </gmd:role>
                  </gmd:CI_ResponsibleParty>
                </gmd:distributorContact>
              </snippet>
            </template>
          </field>

          <action type="add" name="distributorContact" btnClass ="fa fa-user-plus" or="distributor"
                  in="/gmd:MD_Metadata/gmd:distributionInfo/gmd:MD_Distribution"
                  addDirective="data-gn-directory-entry-selector">
            <directiveAttributes
              data-template-add-action="true"
              data-search-action="true"
              data-popup-action="true"
              data-template-type="contact"
              data-insert-modes=""
              data-filter='{"_root": "gmd:CI_ResponsibleParty"}'
              data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{role}"/>
          </action>


          <section name="onlineResource">
            <field name="onlineResource"
                   xpath="/gmd:MD_Metadata/gmd:distributionInfo/gmd:MD_Distribution/gmd:transferOptions"
                   del="."/>

            <action type="add" name="onlineResource" or="transferOptions" btnLabel="transferOption"
                    in="/gmd:MD_Metadata/gmd:distributionInfo/gmd:MD_Distribution"
                    if="count(gmd:MD_Metadata/gmd:distributionInfo/gmd:MD_Distribution)>0"
            >
              <template>
                <snippet>
                  <gmd:transferOptions>
                    <gmd:MD_DigitalTransferOptions>
                      <gmd:onLine>
                        <gmd:CI_OnlineResource>
                          <gmd:linkage>
                            <gmd:URL>http://url.accesso.servizio.it</gmd:URL>
                          </gmd:linkage>
                          <gmd:protocol>
                              <gmx:Anchor xlink:href=""/>
                          </gmd:protocol>
                          <gmd:applicationProfile>
                              <gmx:Anchor xlink:href=""/>
                          </gmd:applicationProfile>
                          <gmd:name>
                              <gco:CharacterString></gco:CharacterString>
                          </gmd:name>                         
                          <gmd:description>
                              <gmx:Anchor xlink:href=""/>
                          </gmd:description>
                        </gmd:CI_OnlineResource>
                      </gmd:onLine>
                    </gmd:MD_DigitalTransferOptions>
                  </gmd:transferOptions>
                </snippet>
              </template>
            </action>

            <action type="add" name="onlineResource" or="distributionInfo" btnLabel="transferOption"
                    in="/gmd:MD_Metadata"
                    if="count(gmd:MD_Metadata/gmd:distributionInfo)=0"
            >
              <template>
                <snippet>
                  <gmd:distributionInfo>
                    <gmd:MD_Distribution>
                      <gmd:transferOptions>
                        <gmd:MD_DigitalTransferOptions>
                          <gmd:onLine>
                            <gmd:CI_OnlineResource>
                              <gmd:linkage>
                                <gmd:URL>http://url.accesso.servizio.it</gmd:URL>
                              </gmd:linkage>
                              <gmd:protocol>
                                  <gmx:Anchor xlink:href=""/>
                              </gmd:protocol>
                              <gmd:applicationProfile>
                                  <gmx:Anchor xlink:href=""/>
                              </gmd:applicationProfile>
                              <gmd:name>
                                  <gco:CharacterString/>
                              </gmd:name>
                              <gmd:description>
                                  <gmx:Anchor xlink:href=""/>
                              </gmd:description>
                              <gmd:function>
                                  <gmd:CI_OnLineFunctionCode 
                                      codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_OnLineFunctionCode" codeListValue="download">
                                  </gmd:CI_OnLineFunctionCode>
                              </gmd:function>
                            </gmd:CI_OnlineResource>
                          </gmd:onLine>
                        </gmd:MD_DigitalTransferOptions>
                      </gmd:transferOptions>
                    </gmd:MD_Distribution>
                  </gmd:distributionInfo>
                </snippet>
              </template>
            </action>
          </section>
        </section>

        <section name ="resourceMaintenance" displayIfRecord="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0">
          <field
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/*/gmd:resourceMaintenance/*/gmd:maintenanceAndUpdateFrequency"
            del="../.."
          >
            <template>
              <values>
                <key label="updateFrequency" xpath="gmd:MD_MaintenanceFrequencyCode/@codeListValue">
                  <codelist name="gmd:MD_MaintenanceFrequencyCode"/>
                </key>
              </values>
              <snippet>
                <gmd:maintenanceAndUpdateFrequency>
                  <gmd:MD_MaintenanceFrequencyCode
                    codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#MD_MaintenanceFrequencyCode" codeListValue="{{updateFrequency}}"/>
                </gmd:maintenanceAndUpdateFrequency>
              </snippet>
            </template>
          </field>

          <action type="add" btnLabel="updateFrequency" or="resourceMaintenance" in="/gmd:MD_Metadata/gmd:identificationInfo/*">
            <template>
              <snippet>
                <gmd:resourceMaintenance>
                  <gmd:MD_MaintenanceInformation>
                    <gmd:maintenanceAndUpdateFrequency>
                      <gmd:MD_MaintenanceFrequencyCode
                        codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#MD_MaintenanceFrequencyCode" codeListValue="asNeeded"/>
                    </gmd:maintenanceAndUpdateFrequency>
                  </gmd:MD_MaintenanceInformation>
                </gmd:resourceMaintenance>
              </snippet>
            </template>
          </action>
        </section>
      </tab>

      <tab id="services" displayIfRecord="count(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification) > 0" mode="flat">

        <section name="metadataInfo">

          <field xpath="/gmd:MD_Metadata/gmd:hierarchyLevel" or ="hierarchyLevel" in ="/gmd:MD_Metadata"/>


          <action type="add" btnLabel="hierarchyLevel"
                  name="hierarchyLevel" or="hierarchyLevel"
                  if="not(gmd:MD_Metadata/gmd:hierarchyLevel)"
                  in="/gmd:MD_Metadata">
            <template>
              <snippet>
                <gmd:hierarchyLevel>
                  <gmd:MD_ScopeCode
                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_ScopeCode"
                    codeListValue="service">service</gmd:MD_ScopeCode>
                </gmd:hierarchyLevel>
              </snippet>
            </template>
          </action>

          <field xpath="/gmd:MD_Metadata/gmd:hierarchyLevelName"
                 or ="hierarchyLevelName" in="/gmd:MD_Metadata"/>

          <action type="add" btnLabel="hierarchyLevelName"
                  or="hierarchyLevelName"
                  in="gmd:MD_Metadata"
                  if="not(gmd:MD_Metadata/hierarchyLevelName)"
          >
            <template>
              <snippet>
                <gmd:hierarchyLevelName>
                  <gmd:CharacterString>servizio</gmd:CharacterString>
                </gmd:hierarchyLevelName>
              </snippet>
            </template>
          </action>

        </section>
        <section name="serviceIdentification">
          <!-- services specific -->

          <section name="serviceClassification">

            <field xpath="gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords
                        [contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/*/text(),'REGOLAMENTO (CE) N. 1205/2008') ]"
                   del="." />

            <action type="add"
                    btnLabel="serviceClassification"
                    or="descriptiveKeywords"
                    in="gmd:MD_Metadata/gmd:identificationInfo/*"

                    if="count(gmd:MD_Metadata/gmd:identificationInfo/*/gmd:descriptiveKeywords/
                          gmd:MD_Keywords/gmd:thesaurusName[starts-with(gmd:CI_Citation/gmd:title/*/text(), 'REGOLAMENTO (CE) N. 1205/2008')])=0">

              <template>
              <snippet>

              <gmd:descriptiveKeywords>
                <gmd:MD_Keywords>
                  <gmd:keyword gco:nilReason="missing">
                    <gmx:Anchor xlink:href=""/>
                  </gmd:keyword>
                  <gmd:type>
                    <gmd:MD_KeywordTypeCode codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#MD_KeywordTypeCode"
                                            codeListValue="theme">theme</gmd:MD_KeywordTypeCode>
                  </gmd:type>
                  <gmd:thesaurusName>
                    <gmd:CI_Citation>
                      <gmd:title>
                        <gco:CharacterString>REGOLAMENTO (CE) N. 1205/2008 DELLA COMMISSIONE del 3 dicembre 2008 recante attuazione della direttiva 2007/2/CE del Parlamento europeo e del Consiglio per quanto riguarda i metadati</gco:CharacterString>
                      </gmd:title>
                      <gmd:date>
                        <gmd:CI_Date>
                          <gmd:date>
                            <gco:Date>2008-12-03</gco:Date>
                          </gmd:date>
                          <gmd:dateType>
                            <gmd:CI_DateTypeCode codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/Codelist/ML_gmxCodelists.xml#CI_DateTypeCode"
                                                 codeListValue="publication">publication</gmd:CI_DateTypeCode>
                          </gmd:dateType>
                        </gmd:CI_Date>
                      </gmd:date>
                      <gmd:identifier>
                        <gmd:MD_Identifier>
                          <gmd:code>
                            <gmx:Anchor
                              xlink:href="http://localhost:8080/geonetwork/srv/ita/thesaurus.download?ref=external.theme.httpinspireeceuropaeumetadatacodelistSpatialDataServiceCategory-SpatialDataServiceCategory_RNDT">geonetwork.thesaurus.external.theme.httpinspireeceuropaeumetadatacodelistSpatialDataServiceCategory-SpatialDataServiceCategory_RNDT</gmx:Anchor>
                          </gmd:code>
                        </gmd:MD_Identifier>
                      </gmd:identifier>
                    </gmd:CI_Citation>
                  </gmd:thesaurusName>
                </gmd:MD_Keywords>
              </gmd:descriptiveKeywords>
              </snippet>
              </template>
          </action>
          </section>


          <field
            templateModeOnly="true"
            notDisplayedIfMissing="true"
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification/srv:serviceType"
            name="serviceType"
            or="serviceType"
            in="gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification">
            <template>
              <values>
                <key label="serviceType" xpath="gco:LocalName">
                  <codelist name="serviceType"/>
                </key>
              </values>
              <snippet>
                <srv:serviceType>
                  <gco:LocalName codeSpace="http://inspire.ec.europa.eu/metadatacodelist/SpatialDataServiceType">
                    {{serviceType}}
                  </gco:LocalName>
                </srv:serviceType>
              </snippet>
            </template>
          </field>

          <field
            templateModeOnly="true"
            notDisplayedIfMissing="true"
            name="couplingType"
            xpath="/gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification/srv:couplingType"
            or="couplingType"
            in="/gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification">
            <template>
              <values>
                <key label="couplingType" xpath="srv:SV_CouplingType/@codeListValue">
                  <codelist name="srv:SV_CouplingType"/>
                </key>
              </values>
              <snippet>
                <srv:couplingType>
                  <srv:SV_CouplingType codeListValue="{{couplingType}}" codeList="#SVCouplingType"/>
                </srv:couplingType >
              </snippet>
            </template>
          </field>

          <action
            type="add"
            btnLabel="couplingType"
            or="couplingType"
            in="/gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification"
            if="count(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification/srv:couplingType)=0">
            <template>
              <snippet>
                <srv:couplingType>
                  <srv:SV_CouplingType codeListValue="loose" codeList="#SVCouplingType"/>
                </srv:couplingType >
              </snippet>
            </template>
          </action>

          <section name="operatesOn">
            <field name="operatesOn" templateModeOnly="true" notDisplayedIfMissing="true"
                   xpath="/gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification/srv:operatesOn"
                   del=".">
              <template>
                <values>
                  <key label="operatesOn"
                       required="true"
                       xpath="@xlink:href"
                       tooltip="srv:operatesOn">
                  </key>
                </values>
                <snippet>
                  <srv:operatesOn xlink:href="{{operatesOn}}" />
                </snippet>
              </template>
            </field>
            <action type="add"
                    btnLabel="operatesOn"
                    or="operatesOn"
                    in="/gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification"
                    if="count(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification) > 0">
              <template>
                <snippet>
                  <srv:operatesOn xlink:href="" />
                </snippet>
              </template>
            </action>
          </section>

            <field
              xpath="/gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification/srv:containsOperations"/>

          <action type="add"
                  btnLabel="containsOperations"
                  name="srv:containsOperations"
                  or="containsOperations"
                  in="/gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification) > 0">
            <template>
              <snippet label="containsOperations">
                <srv:containsOperations>
                  <srv:SV_OperationMetadata>
                    <srv:operationName>
                      <gco:CharacterString></gco:CharacterString>
                    </srv:operationName>
                    <srv:DCP>
                      <srv:DCPList
                        codeList="http://inspire.ec.europa.eu/metadata-codelist/DCPList"
                        codeListValue="webServices">Web services
                      </srv:DCPList>
                    </srv:DCP>
                    <srv:invocationName>
                      <gco:CharacterString></gco:CharacterString>
                    </srv:invocationName>
                    <srv:connectPoint>
                      <gmd:CI_OnlineResource>
                        <gmd:linkage>
                          <gmd:URL>http://</gmd:URL>
                        </gmd:linkage>
                      </gmd:CI_OnlineResource>
                    </srv:connectPoint>
                  </srv:SV_OperationMetadata>
                </srv:containsOperations>
              </snippet>
              <snippet label="callbackMetadata">
                <srv:containsOperations>
                  <srv:SV_OperationMetadata>
                    <srv:operationName>
                      <gco:CharacterString></gco:CharacterString>
                    </srv:operationName>
                    <srv:DCP>
                      <srv:DCPList
                        codeList="http://inspire.ec.europa.eu/metadata-codelist/DCPList"
                        codeListValue="webServices">Web services
                      </srv:DCPList>
                    </srv:DCP>
                    <srv:invocationName>
                      <gco:CharacterString></gco:CharacterString>
                    </srv:invocationName>
                    <srv:connectPoint>
                      <gmd:CI_OnlineResource>
                        <gmd:linkage>
                          <gmd:URL>http://</gmd:URL>
                        </gmd:linkage>
                      </gmd:CI_OnlineResource>
                    </srv:connectPoint>
                    <srv:parameters>
                      <srv:SV_Parameter>
                        <srv:name>
                          <gco:aName>
                            <gco:CharacterString></gco:CharacterString>
                          </gco:aName>
                        </srv:name>
                        <srv:optionality>
                          <gco:CharacterString></gco:CharacterString>
                        </srv:optionality>
                        <srv:repeatability>
                          <gco:Boolean>
                          </gco:Boolean>
                        </srv:repeatability>
                        <srv:valueType>
                          <gco:TypeName>
                            <gco:aName>
                              <gco:CharacterString></gco:CharacterString>
                            </gco:aName>
                          </gco:TypeName>
                        </srv:valueType>
                      </srv:SV_Parameter>
                    </srv:parameters>
                  </srv:SV_OperationMetadata>
                </srv:containsOperations>
              </snippet>
            </template>
          </action>

        </section>


        <section name="dataDistribution" displayIfRecord="count(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification) > 0">
          <field name="onlineResource"
                 xpath="/gmd:MD_Metadata/gmd:distributionInfo/gmd:MD_Distribution/gmd:transferOptions"
                 del="."/>

          <action type="add" name="onlineResource" or="transferOptions" btnLabel="transferOption"
                  in="/gmd:MD_Metadata/gmd:distributionInfo/gmd:MD_Distribution"
                  if ="count(gmd:MD_Metadata/gmd:distributionInfo/gmd:MD_Distribution)>0"
          >
            <template>
              <snippet>
                <gmd:transferOptions>
                  <gmd:MD_DigitalTransferOptions>
                    <gmd:onLine>
                      <gmd:CI_OnlineResource>
                        <gmd:linkage>
                          <gmd:URL>http://url.accesso.servizio.it</gmd:URL>
                        </gmd:linkage>
                        <gmd:protocol>
                          <gmx:Anchor
                            xlink:href=""/>
                        </gmd:protocol>
                        <gmd:name>
                          <gco:CharacterString/>
                        </gmd:name>
                        <gmd:description>
                          <gmx:Anchor xlink:href="http://inspire.ec.europa.eu/metadatacodelist/OnLineDescriptionCode/accessPoint">access point</gmx:Anchor>
                        </gmd:description>
                        <gmd:function>
                          <gmd:CI_OnLineFunctionCode
                            codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_OnLineFunctionCode" codeListValue="download">
                          </gmd:CI_OnLineFunctionCode>
                        </gmd:function>
                      </gmd:CI_OnlineResource>
                    </gmd:onLine>
                  </gmd:MD_DigitalTransferOptions>
                </gmd:transferOptions>
              </snippet>
            </template>
          </action>

          <action type="add" name="onlineResource" or="distributionInfo" btnLabel="transferOption"
                  in="/gmd:MD_Metadata"
                  if="count(gmd:MD_Metadata/gmd:distributionInfo)=0"
          >
            <template>
              <snippet>
                <gmd:distributionInfo>
                  <gmd:MD_Distribution>
                    <gmd:transferOptions>
                      <gmd:MD_DigitalTransferOptions>
                        <gmd:onLine>
                          <gmd:CI_OnlineResource>
                            <gmd:linkage>
                              <gmd:URL>http://url.accesso.servizio.it</gmd:URL>
                            </gmd:linkage>
                            <gmd:protocol>
                              <gmx:Anchor
                                xlink:href=""/>
                            </gmd:protocol>
                            <gmd:name>
                              <gco:CharacterString/>
                            </gmd:name>
                            <gmd:description>
                              <gmx:Anchor xlink:href="http://inspire.ec.europa.eu/metadatacodelist/OnLineDescriptionCode/accessPoint">access point</gmx:Anchor>
                            </gmd:description>
                            <gmd:function>
                              <gmd:CI_OnLineFunctionCode
                                codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_OnLineFunctionCode" codeListValue="download">
                              </gmd:CI_OnLineFunctionCode>
                            </gmd:function>
                          </gmd:CI_OnlineResource>
                        </gmd:onLine>
                      </gmd:MD_DigitalTransferOptions>
                    </gmd:transferOptions>
                  </gmd:MD_Distribution>
                </gmd:distributionInfo>
              </snippet>
            </template>
          </action>
        </section>

        <!-- Conformity - datasets -->
        <section name="servicesQualityInfo">

          <section name="qualityLevel">

            <field xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:scope/gmd:DQ_Scope"/>

            <action type="add" or="scope" btnLabel="qualityLevel"
                    in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                    if="count(/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:scope)=0">
              <template>
                <snippet>
                  <gmd:scope>
                    <gmd:DQ_Scope>
                      <gmd:level>
                        <gmd:MD_ScopeCode codeListValue="service"
                                          codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_ScopeCode">
                          servizio
                        </gmd:MD_ScopeCode>
                      </gmd:level>
                      <gmd:levelDescription>
                        <gmd:MD_ScopeDescription>
                          <gmd:other>
                            <gco:CharacterString>servizio</gco:CharacterString>
                          </gmd:other>
                        </gmd:MD_ScopeDescription>
                      </gmd:levelDescription>
                    </gmd:DQ_Scope>
                  </gmd:scope>
                </snippet>
              </template>
            </action>
          </section>


          <field
            xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_ConceptualConsistency" del=".."/>

          <action type="process"
                  process="sds-add-qualityofservice"
                  if="(count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality[gmd:scope/gmd:DQ_Scope/gmd:level/gmd:MD_ScopeCode/@codeListValue='service']/gmd:report/gmd:DQ_ConceptualConsistency/gmd:nameOfMeasure/gmx:Anchor[text()='availability'])=0 or
                       count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality[gmd:scope/gmd:DQ_Scope/gmd:level/gmd:MD_ScopeCode/@codeListValue='service']/gmd:report/gmd:DQ_ConceptualConsistency/gmd:nameOfMeasure/gmx:Anchor[text()='performance'])=0 or
                       count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality[gmd:scope/gmd:DQ_Scope/gmd:level/gmd:MD_ScopeCode/@codeListValue='service']/gmd:report/gmd:DQ_ConceptualConsistency/gmd:nameOfMeasure/gmx:Anchor[text()='capacity'])=0 )"/>


          <field name="conformitySpecifications" templateModeOnly="true" notDisplayedIfMissing="true"
                 xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_DomainConsistency/gmd:result[gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/text()!='invocable'
                  and gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/text()!='armonized'
                  and gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/text()!='interoperable']"
                 if="count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_DomainConsistency/gmd:result/gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor) > 0"
                 del="../..">
            <template>
              <values>
                <key label="title"
                     xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/text()">
                </key>
                <key label="conformity_linkage"
                     xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/@xlink:href">
                </key>
                <key label="conformity_date"
                     xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:date/gmd:CI_Date/gmd:date/gco:Date"
                     use="gn-date-picker"
                >
                  <directiveAttributes data-tag-name="gco:Date"/>
                </key>
                <key label="pass"
                     xpath="gmd:DQ_ConformanceResult/gmd:pass/gco:Boolean"
                     use="gn-checkbox-with-nilreason">
                  <directiveAttributes
                    data-tag-name="gmd:pass"
                    data-nilreason="eval#gmd:DQ_ConformanceResult/gmd:pass/@gco:nilReason"
                    data-labels='{"true": "conformant", "false": "notConformant", "unknown": "notEvaluated"}'/>
                </key>
              </values>
              <snippet>
                <gmd:result>
                  <gmd:DQ_ConformanceResult>
                    <gmd:specification>
                      <gmd:CI_Citation>
                        <gmd:title>
                          <gmx:Anchor xlink:href="{{conformity_linkage}}">{{title}}</gmx:Anchor>
                        </gmd:title>
                        <gmd:date>
                          <gmd:CI_Date>
                            <gmd:date>
                              {{conformity_date}}
                            </gmd:date>
                            <gmd:dateType>
                              <gmd:CI_DateTypeCode
                                codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                codeListValue="publication"/>
                            </gmd:dateType>
                          </gmd:CI_Date>
                        </gmd:date>
                      </gmd:CI_Citation>
                    </gmd:specification>
                    <gn:copy select="gmd:explanation"/>
                    {{pass}}
                  </gmd:DQ_ConformanceResult>
                </gmd:result>
              </snippet>
            </template>
          </field>

          <field name="conformitySpecifications" templateModeOnly="true" notDisplayedIfMissing="true"
                 xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_DomainConsistency/gmd:result[gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/text()!='invocable'
                  and gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/text()!='armonized'
                  and gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/text()!='interoperable']"
                 if="count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_DomainConsistency/gmd:result/gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gco:CharacterString) > 0"
                 del="../..">
            <template>
              <values>
                <key label="title"
                     xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gco:CharacterString">
                </key>
                <key label="conformity_date"
                     xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:date/gmd:CI_Date/gmd:date/gco:Date"
                     use="gn-date-picker"
                >
                  <directiveAttributes data-tag-name="gco:Date"/>
                </key>
                <key label="pass"
                     xpath="gmd:DQ_ConformanceResult/gmd:pass/gco:Boolean"
                     use="gn-checkbox-with-nilreason">
                  <directiveAttributes
                    data-tag-name="gmd:pass"
                    data-nilreason="eval#gmd:DQ_ConformanceResult/gmd:pass/@gco:nilReason"
                    data-labels='{"true": "conformant", "false": "notConformant", "unknown": "notEvaluated"}'/>
                </key>
              </values>
              <snippet>
                <gmd:result>
                  <gmd:DQ_ConformanceResult>
                    <gmd:specification>
                      <gmd:CI_Citation>
                        <gmd:title>
                          <gco:CharacterString>{{title}}</gco:CharacterString>
                        </gmd:title>
                        <gmd:date>
                          <gmd:CI_Date>
                            <gmd:date>
                              {{conformity_date}}
                            </gmd:date>
                            <gmd:dateType>
                              <gmd:CI_DateTypeCode
                                codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                codeListValue="publication"/>
                            </gmd:dateType>
                          </gmd:CI_Date>
                        </gmd:date>
                      </gmd:CI_Citation>
                    </gmd:specification>
                    <gn:copy select="gmd:explanation"/>
                    {{pass}}
                  </gmd:DQ_ConformanceResult>
                </gmd:result>
              </snippet>
            </template>
          </field>

          <action type="add" name="serviceSpecification" or="report"
                  btnLabel="conformitySpecifications"
                  in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                  if="count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/
                  gmd:DQ_DomainConsistency/gmd:result/gmd:DQ_ConformanceResult[gmd:specification/
                  gmd:CI_Citation/gmd:title/gmx:Anchor/text()!='invocable' and gmd:specification/
                  gmd:CI_Citation/gmd:title/gmx:Anchor/text()!='armonized' and gmd:specification/
                  gmd:CI_Citation/gmd:title/gmx:Anchor/text()!='interoperable']) = 0">
            <template>
              <snippet label="network_services">
                <gmd:report>
                  <gmd:DQ_DomainConsistency>
                    <gmd:result>
                      <gmd:DQ_ConformanceResult>
                        <gmd:specification>
                          <gmd:CI_Citation>
                            <gmd:title>
                              <gmx:Anchor
                                xlink:href="http://data.europa.eu/eli/reg/2009/976">REGOLAMENTO (CE) N. 976/2009
                                DELLA COMMISSIONE del 19 ottobre 2009 recante attuazione della direttiva 2007/2/CE
                                del Parlamento europeo e del Consiglio per quanto riguarda i servizi di rete</gmx:Anchor>
                            </gmd:title>
                            <gmd:date>
                              <gmd:CI_Date>
                                <gmd:date>
                                  <gco:Date>2009-10-19</gco:Date>
                                </gmd:date>
                                <gmd:dateType>
                                  <gmd:CI_DateTypeCode
                                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                    codeListValue="publication"/>
                                </gmd:dateType>
                              </gmd:CI_Date>
                            </gmd:date>
                          </gmd:CI_Citation>
                        </gmd:specification>
                        <gmd:explanation>
                          <gco:CharacterString>Fare riferimento alle
                            specifiche indicate</gco:CharacterString>
                        </gmd:explanation>
                        <gmd:pass gco:nilReason="">
                          <gco:Boolean>true</gco:Boolean>
                        </gmd:pass>
                      </gmd:DQ_ConformanceResult>
                    </gmd:result>
                  </gmd:DQ_DomainConsistency>
                </gmd:report>
              </snippet>
              <snippet label="invocable_services">
                <gmd:report>
                  <gmd:DQ_DomainConsistency>
                    <gmd:result>
                      <gmd:DQ_ConformanceResult>
                        <gmd:specification>
                          <gmd:CI_Citation>
                            <gmd:title>
                              <gmx:Anchor
                                xlink:href="http://data.europa.eu/eli/reg/2010/1089"> REGOLAMENTO (UE) N. 1089/2010 DELLA COMMISSIONE del 23 novembre 2010
                                recante attuazione della direttiva 2007/2/CE del Parlamento europeo e del Consiglio per quanto
                                riguarda l'interoperabilità dei set di dati territoriali e dei servizi di dati territoriali
                              </gmx:Anchor>
                            </gmd:title>
                            <gmd:date>
                              <gmd:CI_Date>
                                <gmd:date>
                                  <gco:Date>2010-12-08</gco:Date>
                                </gmd:date>
                                <gmd:dateType>
                                  <gmd:CI_DateTypeCode
                                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                    codeListValue="publication"/>
                                </gmd:dateType>
                              </gmd:CI_Date>
                            </gmd:date>
                          </gmd:CI_Citation>
                        </gmd:specification>
                        <gmd:explanation>
                          <gco:CharacterString>Fare riferimento alle
                            specifiche indicate</gco:CharacterString>
                        </gmd:explanation>
                        <gmd:pass gco:nilReason="">
                          <gco:Boolean>true</gco:Boolean>
                        </gmd:pass>
                      </gmd:DQ_ConformanceResult>
                    </gmd:result>
                  </gmd:DQ_DomainConsistency>
                </gmd:report>
              </snippet>
              <snippet label="freeText">
                <gmd:report>
                  <gmd:DQ_DomainConsistency>
                    <gmd:result>
                      <gmd:DQ_ConformanceResult>
                        <gmd:specification>
                          <gmd:CI_Citation>
                            <gmd:title>
                              <gmx:Anchor
                                xlink:href=""></gmx:Anchor>
                            </gmd:title>
                            <gmd:date>
                              <gmd:CI_Date>
                                <gmd:date>
                                  <gco:Date></gco:Date>
                                </gmd:date>
                                <gmd:dateType>
                                  <gmd:CI_DateTypeCode
                                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                    codeListValue="publication"/>
                                </gmd:dateType>
                              </gmd:CI_Date>
                            </gmd:date>
                          </gmd:CI_Citation>
                        </gmd:specification>
                        <gmd:explanation>
                          <gco:CharacterString>Fare riferimento alle
                            specifiche indicate</gco:CharacterString>
                        </gmd:explanation>
                        <gmd:pass gco:nilReason="">
                          <gco:Boolean>true</gco:Boolean>
                        </gmd:pass>
                      </gmd:DQ_ConformanceResult>
                    </gmd:result>
                  </gmd:DQ_DomainConsistency>
                </gmd:report>
              </snippet>
            </template>
          </action>



          <field name="serviceCategory" templateModeOnly="true" notDisplayedIfMissing="true"
                 xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/
                    gmd:report/gmd:DQ_DomainConsistency/gmd:result[gmd:DQ_ConformanceResult/gmd:specification/
                  gmd:CI_Citation/gmd:title/gmx:Anchor/text()='invocable' or gmd:DQ_ConformanceResult/gmd:specification/
                  gmd:CI_Citation/gmd:title/gmx:Anchor/text()='armonized' or gmd:DQ_ConformanceResult/gmd:specification/
                  gmd:CI_Citation/gmd:title/gmx:Anchor/text()='interoperable']">
            <template>
              <values>
                <key label="title"
                     xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/text()">
                </key>
                <key label="conformity_linkage"
                     xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/@xlink:href">
                </key>
                <key label="conformity_date"
                     xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:date/gmd:CI_Date/gmd:date/gco:Date"
                     use="gn-date-picker"
                >
                  <directiveAttributes data-tag-name="gco:Date"/>
                </key>
                <key label="pass"
                     xpath="gmd:DQ_ConformanceResult/gmd:pass/gco:Boolean"
                     use="gn-checkbox-with-nilreason">
                  <directiveAttributes
                    data-tag-name="gmd:pass"
                    data-nilreason="eval#gmd:DQ_ConformanceResult/gmd:pass/@gco:nilReason"
                    data-labels='{"true": "conformant", "false": "notConformant", "unknown": "notEvaluated"}'/>
                </key>
              </values>
              <snippet>
                <gmd:result>
                  <gmd:DQ_ConformanceResult>
                    <gmd:specification>
                      <gmd:CI_Citation>
                        <gmd:title>
                          <gmx:Anchor xlink:href="{{conformity_linkage}}">{{title}}</gmx:Anchor>
                        </gmd:title>
                        <gmd:date>
                          <gmd:CI_Date>
                            <gmd:date>
                              {{conformity_date}}
                            </gmd:date>
                            <gmd:dateType>
                              <gmd:CI_DateTypeCode
                                codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                codeListValue="publication"/>
                            </gmd:dateType>
                          </gmd:CI_Date>
                        </gmd:date>
                      </gmd:CI_Citation>
                    </gmd:specification>
                    <gn:copy select="gmd:explanation"/>
                    {{pass}}
                  </gmd:DQ_ConformanceResult>
                </gmd:result>
              </snippet>
            </template>
          </field>

          <action type="add" name="serviceCategory" or="report"
                  btnLabel="sds-category"
                  in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                  if="count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_DomainConsistency/gmd:result/gmd:DQ_ConformanceResult/gmd:specification[contains(./gmd:CI_Citation/gmd:title/gmx:Anchor/text(),'invocable') or contains(./gmd:CI_Citation/gmd:title/gmx:Anchor/text(),'interoperable') or contains(./gmd:CI_Citation/gmd:title/gmx:Anchor/text(),'armonized')]) = 0">
            <template>
              <snippet label="invocable_services">
                <gmd:report>
                  <gmd:DQ_DomainConsistency>
                    <gmd:result>
                      <gmd:DQ_ConformanceResult>
                        <gmd:specification>
                          <gmd:CI_Citation>
                            <gmd:title>
                              <gmx:Anchor
                                xlink:href="http://inspire.ec.europa.eu/id/ats/metadata/2.0/sds-invocable"
                                xlink:title="INSPIRE Invocable Spatial Data Services metadata">
                                invocable
                              </gmx:Anchor>
                            </gmd:title>
                            <gmd:date>
                              <gmd:CI_Date>
                                <gmd:date>
                                  <gco:Date>2016-05-01</gco:Date>
                                </gmd:date>
                                <gmd:dateType>
                                  <gmd:CI_DateTypeCode
                                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                    codeListValue="publication"/>
                                </gmd:dateType>
                              </gmd:CI_Date>
                            </gmd:date>
                          </gmd:CI_Citation>
                        </gmd:specification>
                        <gmd:explanation>
                          <gco:CharacterString>Questo servizio di dati
                            territoriali è conforme ai requisiti INSPIRE per i Servizi di Dati Territoriali
                            Invocabili</gco:CharacterString>
                        </gmd:explanation>
                        <gmd:pass>
                          <gco:Boolean>true</gco:Boolean>
                        </gmd:pass>
                      </gmd:DQ_ConformanceResult>
                    </gmd:result>
                  </gmd:DQ_DomainConsistency>
                </gmd:report>
              </snippet>
              <snippet label="armonized_services">
                <gmd:report>
                  <gmd:DQ_DomainConsistency>
                    <gmd:result>
                      <gmd:DQ_ConformanceResult>
                        <gmd:specification>
                          <gmd:CI_Citation>
                            <gmd:title>
                              <gmx:Anchor
                                xlink:href="http://inspire.ec.europa.eu/id/ats/metadata/2.0/sds-armonized"
                                xlink:title="INSPIRE Armonized Spatial Data Services metadata">
                                armonized
                              </gmx:Anchor>
                            </gmd:title>
                            <gmd:date>
                              <gmd:CI_Date>
                                <gmd:date>
                                  <gco:Date>2016-05-01</gco:Date>
                                </gmd:date>
                                <gmd:dateType>
                                  <gmd:CI_DateTypeCode
                                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                    codeListValue="publication"/>
                                </gmd:dateType>
                              </gmd:CI_Date>
                            </gmd:date>
                          </gmd:CI_Citation>
                        </gmd:specification>
                        <gmd:explanation>
                          <gco:CharacterString>Questo servizio di dati
                            territoriali è conforme ai requisiti INSPIRE per i Servizi di Dati Territoriali
                            Armonizzati</gco:CharacterString>
                        </gmd:explanation>
                        <gmd:pass>
                          <gco:Boolean>true</gco:Boolean>
                        </gmd:pass>
                      </gmd:DQ_ConformanceResult>
                    </gmd:result>
                  </gmd:DQ_DomainConsistency>
                </gmd:report>
              </snippet>
              <snippet label="interoperable_services">
                <gmd:report>
                  <gmd:DQ_DomainConsistency>
                    <gmd:result>
                      <gmd:DQ_ConformanceResult>
                        <gmd:specification>
                          <gmd:CI_Citation>
                            <gmd:title>
                              <gmx:Anchor
                                xlink:href="http://inspire.ec.europa.eu/id/ats/metadata/2.0/sds-interoperable"
                                xlink:title="INSPIRE Interoperable Spatial Data Services metadata">
                                interoperable
                              </gmx:Anchor>
                            </gmd:title>
                            <gmd:date>
                              <gmd:CI_Date>
                                <gmd:date>
                                  <gco:Date>2016-05-01</gco:Date>
                                </gmd:date>
                                <gmd:dateType>
                                  <gmd:CI_DateTypeCode
                                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                    codeListValue="publication"/>
                                </gmd:dateType>
                              </gmd:CI_Date>
                            </gmd:date>
                          </gmd:CI_Citation>
                        </gmd:specification>
                        <gmd:explanation>
                          <gco:CharacterString>Questo servizio di dati
                            territoriali è conforme ai requisiti INSPIRE per i Servizi di Dati Territoriali
                            Interoperabili</gco:CharacterString>
                        </gmd:explanation>
                        <gmd:pass>
                          <gco:Boolean>true</gco:Boolean>
                        </gmd:pass>
                      </gmd:DQ_ConformanceResult>
                    </gmd:result>
                  </gmd:DQ_DomainConsistency>
                </gmd:report>
              </snippet>
            </template>
          </action>
        </section>

        <section name="referenceSystems">
          <section name="spatialReferenceSystem" displayIfRecord="count(gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier/gmd:RS_Identifier[boolean(./gmd:code/gmx:Anchor) or boolean(./gmd:codeSpace/gco:CharacterString)])>0
          or count(gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier/gmd:RS_Identifier/gmd:code[contains(.,'RDN') or starts-with(.,'ED50')
          or contains(.,'MonteMario') or contains(.,'ETRS') or contains(.,'ITRS') or contains(.,'WGS') or contains(.,'EPSG')])>0">

            <field
              xpath="/gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier[boolean(gmd:RS_Identifier/gmd:code/gmx:Anchor)]"
              del="../..">
              <template>
                <values>
                  <key label="code"
                       xpath="gmd:RS_Identifier/gmd:code/gmx:Anchor"
                       tooltip="gmd:referenceSystemInfo"/>
                  <key label="xlink"
                       xpath="gmd:RS_Identifier/gmd:code/gmx:Anchor/xlink:href"/>
                </values>
                <snippet>
                  <gmd:referenceSystemIdentifier>
                    <gmd:RS_Identifier>
                      <gmd:code>
                        <gmx:Anchor xlink:href="{{xlink}}">{{code}}</gmx:Anchor>
                      </gmd:code>
                    </gmd:RS_Identifier>
                  </gmd:referenceSystemIdentifier>
                </snippet>
              </template>
            </field>

            <field
              xpath="/gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier[
            starts-with(./gmd:RS_Identifier/gmd:code/gco:CharacterString,'WGS') or starts-with(./gmd:RS_Identifier/gmd:code/gco:CharacterString,'EPSG') or starts-with(./gmd:RS_Identifier/gmd:code/gco:CharacterString,'RND')
            or starts-with(./gmd:RS_Identifier/gmd:code/gco:CharacterString,'ETRS') or starts-with(./gmd:RS_Identifier/gmd:code/gco:CharacterString,'ITRS')
            or starts-with(./gmd:RS_Identifier/gmd:code/gco:CharacterString,'MonteMario') or starts-with(./gmd:RS_Identifier/gmd:code/gco:CharacterString,'ED50')
            or boolean(./gmd:RS_Identifier/gmd:codeSpace/gco:CharacterString)]"
              del="../..">
              <template>
                <values>
                  <key label="code"
                       xpath="gmd:RS_Identifier/gmd:code/gco:CharacterString"
                       tooltip="gmd:referenceSystemInfo"/>
                  <key label="codeSpace"
                       xpath="gmd:RS_Identifier/gmd:codeSpace/gco:CharacterString"/>
                </values>
                <snippet>
                  <gmd:referenceSystemIdentifier>
                    <gmd:RS_Identifier>
                      <gmd:code>
                        <gco:CharacterString>{{code}}</gco:CharacterString>
                      </gmd:code>
                      <gmd:codeSpace>
                        <gco:CharacterString>{{codeSpace}}</gco:CharacterString>
                      </gmd:codeSpace>
                    </gmd:RS_Identifier>
                  </gmd:referenceSystemIdentifier>
                </snippet>
              </template>
            </field>

          </section>

          <action type="add"
                  btnLabel="spatialReferenceSystem"
                  or="referenceSystemInfo"
                  in="/gmd:MD_Metadata"
                  if="count(gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier/gmd:RS_Identifier[boolean(./gmd:code/gmx:Anchor) or boolean(./gmd:codeSpace/gco:CharacterString)])=0
                  and count(gmd:MD_Metadata/gmd:referenceSystemInfo/gmd:MD_ReferenceSystem/gmd:referenceSystemIdentifier/gmd:RS_Identifier/gmd:code[contains(.,'RDN') or starts-with(.,'ED50')
                  or contains(.,'MonteMario') or contains(.,'ETRS') or contains(.,'ITRS') or contains(.,'WGS') or contains(.,'EPSG')])=0"
          >
            <template>
              <snippet label="anchor">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href=""></gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="freeText">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gco:CharacterString></gco:CharacterString>
                        </gmd:code>
                        <gmd:codeSpace>
                          <gco:CharacterString></gco:CharacterString>
                        </gmd:codeSpace>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG4936">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4936">ETRS89-XYZ</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG4937">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4937">ETRS89-GRS80</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG4258">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4258">ETRS89-GRS80</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG3035">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/3035">ETRS89-LAEA</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG3034">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/3034">ETRS89-LCC</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG25832">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/25832">ETRS89-UTM32N</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG25833">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/25833">ETRS89-UTM33N</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG25834">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/25834">ETRS89-UTM34N</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG6704">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor  xlink:href="http://www.opengis.net/def/crs/EPSG/0/6704">RDN2008-6704</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG6705">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6705">RDN2008-6705</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG6706">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6706">RDN2008-6706</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG6707">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6707">RDN2008-TM32NE</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG7791">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/9.6.1/7791">RDN2008-TM32EN</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG6708">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6708">RDN2008-TM33NE</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG7792">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code >
                          <gmx:Anchor  xlink:href="http://www.opengis.net/def/crs/EPSG/9.6.1/7792">RDN2008-TM33EN</gmx:Anchor>
                        </gmd:code >
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG6709">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6709">RDN2008-TM34NE</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG7793">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor  xlink:href="http://www.opengis.net/def/crs/EPSG/9.6.1/7793">RDN2008-TM34EN</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG6875">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6875">RDN2008-ItalyNE</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG7794">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/9.6.1/7794">RDN2008-ItalyEN</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG6876">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/6876">RDN2008-12NE</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG7795">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/9.6.1/7795">RDN2008-12EN</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG4230">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4230">ED50</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG23032">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/23032">ED50-UTM32N</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG23033">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/23033">ED50-UTM33N</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG23034">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/23034">ED50-UTM34N</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG4806">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4806">Monte-Mario-Rome</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG4265">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/4265">Monte-Mario</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG3003">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/3003">Monte-Mario-Italy1</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
              <snippet label="EPSG3004">
                <gmd:referenceSystemInfo>
                  <gmd:MD_ReferenceSystem>
                    <gmd:referenceSystemIdentifier>
                      <gmd:RS_Identifier>
                        <gmd:code>
                          <gmx:Anchor xlink:href="http://www.opengis.net/def/crs/EPSG/0/3004">Monte-Mario-Italy2</gmx:Anchor>
                        </gmd:code>
                      </gmd:RS_Identifier>
                    </gmd:referenceSystemIdentifier>
                  </gmd:MD_ReferenceSystem>
                </gmd:referenceSystemInfo>
              </snippet>
            </template>
          </action>
        </section>
      </tab>

      <tab id="raster" mode="flat" displayIfRecord="count(gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription)>0">

        <section name ="contentInfo">

          <field xpath="gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription/gmd:attributeDescription"
                 or ="gmd:attributeDescription"
                 in="gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription"/>

          <field xpath="gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription/gmd:contentType"
                 or ="gmd:contentType"
                 in="gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription"/>

          <field xpath="gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription/gmd:dimension/gmd:MD_Band/gmd:bitsPerValue"
                 />
          <action type="add" name="bitsPerValue" or="dimension" in="gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription"
                  if="count(gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription/gmd:dimension/gmd:MD_Band/gmd:bitsPerValue)=0"
          >
            <template>
              <snippet>
                <gmd:dimension>
                  <gmd:MD_Band>
                    <gmd:bitsPerValue>
                      <gco:Integer></gco:Integer>
                    </gmd:bitsPerValue>
                  </gmd:MD_Band>
                </gmd:dimension>
              </snippet>
            </template>
          </action>

          <field xpath="gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription/gmd:triangulationIndicator"
                 />
          <action type="add" btnLabel="triangulationIndicator" or ="triangulationIndicator"
                  in="gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription"
                  if="count(gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription/gmd:triangulationIndicator)=0"
          >
            <template>
              <snippet>
                <gmd:triangulationIndicator>
                  <gco:Boolean>true</gco:Boolean >
                </gmd:triangulationIndicator>
              </snippet>
            </template>
          </action>

        </section>

        <section name="spatialRepresentation">
          <field xpath ="gmd:MD_Metadata/gmd:spatialRepresentationInfo/*/gmd:numberOfDimensions"/>
          <action type="add" name="gmd:numberOfDimensions"
                  btnLabel="numberOfDimensions"
                  or ="numberOfDimensions"
                  in = "gmd:MD_Metadata/gmd:spatialRepresentationInfo/*"
                  if="count(gmd:MD_Metadata/gmd:spatialRepresentationInfo/*/gmdNumberOfDimension)=0">
            <template>
              <snippet>
                <gmd:numberOfDimensions>
                  <gco:Integer/>
                </gmd:numberOfDimensions>
              </snippet>
            </template>
          </action>

          <field name="axisDimensionProperties"
            xpath ="gmd:MD_Metadata/gmd:spatialRepresentationInfo/*/gmd:axisDimensionProperties"/>

          <action type="add"
                  btnLabel="axisDimensionProperties"
                  name="axisDimensionProperty"
                  or ="axisDimensionProperties"
                  in = "gmd:MD_Metadata/gmd:spatialRepresentationInfo/*"
          >
            <template>
              <snippet>
                <gmd:axisDimensionProperties>
                  <gmd:MD_Dimension>
                    <gmd:dimensionName>
                      <gmd:MD_DimensionNameTypeCode
                        codeListValue="row"
                        codeList="https://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_DimensionNameTypeCode"/>
                    </gmd:dimensionName>
                    <gmd:dimensionSize>
                      <gco:Integer/>
                    </gmd:dimensionSize>
                    <gmd:resolution>
                      <gco:Measure uom="http://standards.iso.org/iso/19139/resources/uom/ML_gmxUom.xml#m">
                      </gco:Measure>
                    </gmd:resolution>
                  </gmd:MD_Dimension>
                </gmd:axisDimensionProperties>
              </snippet>
            </template>
          </action>

          <field xpath ="gmd:MD_Metadata/gmd:spatialRepresentationInfo/*/gmd:cellGeometry"
                 or ="cellGeometry"
                 in="/gmd:MD_Metadata/gmd:spatialRepresentationInfo/*"/>

          <field xpath ="gmd:MD_Metadata/gmd:spatialRepresentationInfo/*/gmd:transformationParameterAvailability"
                 or ="transformationParameterAvailability"
                 in="/gmd:MD_Metadata/gmd:spatialRepresentationInfo/*"/>

          <section name="georectifiedRaster" displayIfRecord="count(gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georectified)>0">

            <field xpath="gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georectified/gmd:checkPointAvailability"
                   or="checkPointAvailability" in = "gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georectified"/>

            <field xpath="gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georectified/gmd:checkPointDescription"
                   or="checkPointDescription" in = "gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georectified"/>


              <field name="cornerPoints" 
                     xpath="/gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georectified/gmd:cornerPoints"
                     del=".">
                <template>
                  <values>
                    <key label="name" xpath="gml:Point/gml:name"/>
                    <key label="coordinates" xpath="gml:Point/gml:coordinates"/>
                  </values>
                  <snippet>
                    <gmd:cornerPoints>
                      <gml:Point gml:id="">
                        <gml:name>{{name}}</gml:name>
                        <gml:coordinates decimal="." cs=",">{{coordinates}}</gml:coordinates>
                      </gml:Point>
                    </gmd:cornerPoints>
                  </snippet>
                </template>
              </field>

              <action type="add" btnLabel="cornerPoints" name="gmd:cornerPoints" or="cornerPoints" 
                      in ="gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georectified">
                <template>
                  <snippet>
                    <gmd:cornerPoints>
                      <gml:Point gml:id="">
                        <gml:name/>
                        <gml:coordinates decimal="." cs=","/>
                      </gml:Point>
                    </gmd:cornerPoints>
                  </snippet>
                </template>
              </action>

            <field xpath="gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georectified/gmd:pointInPixel/gmd:MD_PixelOrientationCode"
                   name="pointInPixel"
                   or ="pointInPixel"
                   in="gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georectified"
                   del="."/>

          </section>

          <section name="georeferenceableRaster" displayIfRecord="count(gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georeferenceable)>0">

            <field xpath="gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georeferenceable/gmd:controlPointAvailability"
                   or="controlPointAvailability" in = "gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georeferenceable"/>

            <field xpath="gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georeferenceable/gmd:orientationParameterAvailability"
                   or="orientationParameterAvailability" in = "gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georeferenceable"/>

            <field xpath="gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georeferenceable/gmd:georeferencedParameters"/>

            <action type="add" name="georeferencedParameters" or="georeferencedParameters" in ="gmd:MD_Metadata/gmd:spatialRepresentationInfo/gmd:MD_Georeferenceable">
              <template>
                <snippet>
                  <gmd:georeferencedParameters>
                    <gco:Record></gco:Record>
                  </gmd:georeferencedParameters>
                </snippet>
              </template>
            </action>

          </section>

        </section>
      </tab>
      <flatModeExceptions>
        <for name="gmd:distributionFormat"/>
        <for name="gmd:processor"/>
        <for name="gmd:topicCategory"/>
        <for name="srv:containsOperations"/>
        <for name="srv:SV_OperationMetadata"/>
        <for name="srv:SV_Parameter"/>
        <for name="srv:DCP"/>
        
        <for name="srv:operationName"/>
      </flatModeExceptions>
    </view>

    <view name="advanced">
    <sidePanel>
      <directive data-gn-validation-report=""/>
      <directive data-gn-onlinesrc-list=""/>
      <directive gn-geo-publisher=""
                 data-ng-if="gnCurrentEdit.geoPublisherConfig"
                 data-config="{{gnCurrentEdit.geoPublisherConfig}}"
                 data-lang="lang"/>
      <directive data-gn-suggestion-list=""/>
      <directive data-gn-need-help="user-guide/describing-information/creating-metadata.html"/>
    </sidePanel>

      <tab id="metadata" default="true">
        <section name="metadata">
          <field xpath="/gmd:MD_Metadata/gmd:fileIdentifier" or="fileIdentifier" in="gmd:MD_Metadata"/>

          <field
            xpath="/gmd:MD_Metadata/gmd:language" or ="language" in ="gmd:MD_Metadata"/>


          <field xpath="/gmd:MD_Metadata/gmd:characterSet" or="characterSet" in ="/gmd:MD_Metadata"/>

          <field xpath="/gmd:MD_Metadata/gmd:parentIdentifier" or="parentIdentifier" in ="/gmd:MD_Metadata"/>
          <field xpath="/gmd:MD_Metadata/gmd:contact" or="contact" in="/gmd:MD_Metadata"/>


          <field xpath="/gmd:MD_Metadata/gmd:dateStamp" or ="dateStamp" in="/gmd:MD_Metadata"/>
          <field
            xpath="/gmd:MD_Metadata/gmd:metadataStandardName"
            del="."
          />
          <action type="add" btnLabel="standardName"
                  or="metadataStandardName"
                  in="gmd:MD_Metadata"
                  if="count(gmd:MD_Metadata/gmd:metadataStandardName)=0">
            <template>
              <snippet>
                <gmd:metadataStandardName>
                  <gmx:Anchor xlink:href="https://registry.geodati.gov.it/document/lgrndt">Linee Guida RNDT</gmx:Anchor>
                </gmd:metadataStandardName>
              </snippet>
            </template>

          </action>

          <field xpath="/gmd:MD_Metadata/gmd:metadataStandardVersion" or="metadataStandardVersion" in="/gmd:MD_Metadata"/>

          <field xpath="/gmd:MD_Metadata/gmd:hierarchyLevel" name="hierarchyLevel"/>

          <action type="add" btnLabel="hierarchyLevel"
                  name="hierarchyLevel" or="hierarchyLevel"
                  if="count(gmd:MD_Metadata/hierarchyLevel) = 0"
                  in="/gmd:MD_Metadata">
            <template>
              <snippet>
                <gmd:hierarchyLevel>
                  <gmd:MD_ScopeCode
                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_ScopeCode"
                    codeListValue="service">service</gmd:MD_ScopeCode>
                </gmd:hierarchyLevel>
              </snippet>
            </template>
          </action>

          <field xpath="/gmd:MD_Metadata/gmd:hierarchyLevelName"
                 name="hierarchyLevelName"/>

          <action type="add"
                  name="hierarchyLevelName"
                  btnLabel="hierarchyLevelName"
                  or="hierarchyLevelName"
                  in="/gmd:MD_Metadata"
                  if="count(gmd:MD_Metadata/hierarchyLevelName) = 0"
          >
            <template>
              <snippet>
                <gmd:hierarchyLevelName>
                  <gmd:CharacterString>servizio</gmd:CharacterString>
                </gmd:hierarchyLevelName>
              </snippet>
            </template>
          </action>
        </section>
      </tab>
      <tab id="identificationInfo">
        <section xpath="/gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification"
                 or="SV_ServiceIdentification"
                 in="gmd:MD_Metadata/gmd:identificationInfo"
        />
        <section xpath="/gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification"
                 or="gmd:MD_MetadataIdentification"
                 in="gmd:MD_Metadata/gmd:identificationInfo"/>
      </tab>
      <tab id="dataDistribution">
        <section xpath="/gmd:MD_Metadata/gmd:distributionInfo" or="distributionInfo"
                 in="/gmd:MD_Metadata"/>
      </tab>
      <tab id="dataQuality">
        <section name="qualityInfo">

          <field name="conformitySpecifications" templateModeOnly="true"
                 xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/
                    gmd:report/gmd:DQ_DomainConsistency/gmd:result[count(gmd:DQ_ConformanceResult/gmd:specification/
                      gmd:CI_Citation/gmd:title/gmx:Anchor) > 0]"
                 if="count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/
                      gmd:report/gmd:DQ_DomainConsistency/gmd:result/gmd:DQ_ConformanceResult/gmd:specification/
                      gmd:CI_Citation/gmd:title[gmx:Anchor]) > 0"
                 del="../..">
            <template>
              <values>
                <key label="conformity_desc"
                     xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/text()"
                     tooltip="gmd:pass">
                  <helper name="gmd:title"
                          context="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_DomainConsistency/gmd:result/gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title"/>
                </key>
                <key label="conformity_linkage"
                     xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:title/gmx:Anchor/@xlink:href">
                </key>
                <key label="conformity_date"
                     xpath="gmd:DQ_ConformanceResult/gmd:specification/gmd:CI_Citation/gmd:date/gmd:CI_Date/gmd:date/gco:Date"
                     use="gn-date-picker">
                  <directiveAttributes
                    data-tag-name="gco:Date"
                  />
                </key>
                <key label="pass"
                     xpath="gmd:DQ_ConformanceResult/gmd:pass/gco:Boolean"
                     use="gn-checkbox-with-nilreason">
                  <directiveAttributes
                    data-tag-name="gmd:pass"
                    data-nilreason="eval#gmd:DQ_ConformanceResult/gmd:pass/@gco:nilReason"
                    data-labels='{"true": "conformant", "false": "notConformant", "unknown": "notEvaluated"}'/>
                </key>
              </values>
              <snippet>
                <gmd:result>
                  <gmd:DQ_ConformanceResult>
                    <gmd:specification>
                      <gmd:CI_Citation>
                        <gmd:title>
                          <gmx:Anchor xlink:href="{{conformity_linkage}}">{{conformity_desc}}</gmx:Anchor>
                        </gmd:title>
                        <gmd:date>
                          <gmd:CI_Date>
                            <gmd:date>
                              {{conformity_date}}
                            </gmd:date>
                            <gmd:dateType>
                              <gmd:CI_DateTypeCode
                                codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                codeListValue="publication"/>
                            </gmd:dateType>
                          </gmd:CI_Date>
                        </gmd:date>
                      </gmd:CI_Citation>
                    </gmd:specification>
                    <gn:copy select="gmd:explanation"/>
                    {{pass}}
                  </gmd:DQ_ConformanceResult>
                </gmd:result>
              </snippet>
            </template>
          </field>


          <action type="add" name="conformity" or="report"
                  btnLabel="conformitySpecifications"
                  in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0 and
                    count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_DomainConsistency/gmd:result/gmd:DQ_ConformanceResult)=0">
            <template>
              <snippet>
                <gmd:report>
                  <gmd:DQ_DomainConsistency>
                    <gmd:result>
                      <gmd:DQ_ConformanceResult>
                        <gmd:specification>
                          <gmd:CI_Citation>
                            <gmd:title>
                              <gmx:Anchor xlink:href="http://data.europa.eu/eli/reg/2010/1089">
                                REGOLAMENTO (UE) N. 1089/2010 DELLA COMMISSIONE del 23 novembre 2010
                                recante attuazione della direttiva 2007/2/CE del Parlamento europeo e del Consiglio per quanto
                                riguarda l'interoperabilità dei set di dati territoriali e dei servizi di dati territoriali
                              </gmx:Anchor>
                            </gmd:title>
                            <gmd:date>
                              <gmd:CI_Date>
                                <gmd:date>
                                  <gco:Date>2010-12-08</gco:Date>
                                </gmd:date>
                                <gmd:dateType>
                                  <gmd:CI_DateTypeCode
                                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                    codeListValue="publication"/>
                                </gmd:dateType>
                              </gmd:CI_Date>
                            </gmd:date>
                          </gmd:CI_Citation>
                        </gmd:specification>
                        <gmd:explanation>
                          <gco:CharacterString>Fare riferimento alle specifiche indicate</gco:CharacterString>
                        </gmd:explanation>
                        <gmd:pass>
                          <gco:Boolean>true</gco:Boolean>
                        </gmd:pass>
                      </gmd:DQ_ConformanceResult>
                    </gmd:result>
                  </gmd:DQ_DomainConsistency>
                </gmd:report>
              </snippet>
            </template>
          </action>

          <action type="add" name="serviceSpecification" or="report"
                  btnLabel="conformitySpecifications"
                  in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification) > 0 and
                    count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_DomainConsistency/gmd:result/gmd:DQ_ConformanceResult) = 0">
            <template>
              <snippet label="network_services">
                <gmd:report>
                  <gmd:DQ_DomainConsistency>
                    <gmd:result>
                      <gmd:DQ_ConformanceResult>
                        <gmd:specification>
                          <gmd:CI_Citation>
                            <gmd:title>
                              <gmx:Anchor
                                xlink:href="http://data.europa.eu/eli/reg/2009/976">REGOLAMENTO (CE) N. 976/2009
                                DELLA COMMISSIONE del 19 ottobre 2009 recante attuazione della direttiva 2007/2/CE
                                del Parlamento europeo e del Consiglio per quanto riguarda i servizi di rete</gmx:Anchor>
                            </gmd:title>
                            <gmd:date>
                              <gmd:CI_Date>
                                <gmd:date>
                                  <gco:Date> 2009-10-19</gco:Date>
                                </gmd:date>
                                <gmd:dateType>
                                  <gmd:CI_DateTypeCode
                                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                    codeListValue="publication"/>
                                </gmd:dateType>
                              </gmd:CI_Date>
                            </gmd:date>
                          </gmd:CI_Citation>
                        </gmd:specification>
                        <gmd:explanation>
                          <gco:CharacterString>Fare riferimento alle specifiche indicate</gco:CharacterString>
                        </gmd:explanation>
                        <gmd:pass>
                          <gco:Boolean>true</gco:Boolean>
                        </gmd:pass>
                      </gmd:DQ_ConformanceResult>
                    </gmd:result>
                  </gmd:DQ_DomainConsistency>
                </gmd:report>
              </snippet>
              <snippet label="invocable_service">
                <gmd:report>
                  <gmd:DQ_DomainConsistency>
                    <gmd:result>
                      <gmd:DQ_ConformanceResult>
                        <gmd:specification>
                          <gmd:CI_Citation>
                            <gmd:title>
                              <gmx:Anchor
                                xlink:href="http://data.europa.eu/eli/reg/2010/1089"> REGOLAMENTO (UE) N. 1089/2010 DELLA COMMISSIONE del 23 novembre 2010
                                recante attuazione della direttiva 2007/2/CE del Parlamento europeo e del Consiglio per quanto
                                riguarda l'interoperabilità dei set di dati territoriali e dei servizi di dati territoriali
                              </gmx:Anchor>
                            </gmd:title>
                            <gmd:date>
                              <gmd:CI_Date>
                                <gmd:date>
                                  <gco:Date>2010-12-08</gco:Date>
                                </gmd:date>
                                <gmd:dateType>
                                  <gmd:CI_DateTypeCode
                                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                    codeListValue="publication"/>
                                </gmd:dateType>
                              </gmd:CI_Date>
                            </gmd:date>
                          </gmd:CI_Citation>
                        </gmd:specification>
                        <gmd:explanation>
                          <gco:CharacterString>Fare riferimento alle specifiche indicate</gco:CharacterString>
                        </gmd:explanation>
                        <gmd:pass>
                          <gco:Boolean>true</gco:Boolean>
                        </gmd:pass>
                      </gmd:DQ_ConformanceResult>
                    </gmd:result>
                  </gmd:DQ_DomainConsistency>
                </gmd:report>
              </snippet>
              <snippet label="freeText">
                <gmd:report>
                  <gmd:DQ_DomainConsistency>
                    <gmd:result>
                      <gmd:DQ_ConformanceResult>
                        <gmd:specification>
                          <gmd:CI_Citation>
                            <gmd:title>
                              <gmx:Anchor
                                xlink:href=""></gmx:Anchor>
                            </gmd:title>
                            <gmd:date>
                              <gmd:CI_Date>
                                <gmd:date>
                                  <gco:Date></gco:Date>
                                </gmd:date>
                                <gmd:dateType>
                                  <gmd:CI_DateTypeCode
                                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                    codeListValue="publication"/>
                                </gmd:dateType>
                              </gmd:CI_Date>
                            </gmd:date>
                          </gmd:CI_Citation>
                        </gmd:specification>
                        <gmd:explanation>
                          <gco:CharacterString>Fare riferimento alle specifiche indicate</gco:CharacterString>
                        </gmd:explanation>
                        <gmd:pass gco:nilReason="">
                          <gco:Boolean>true</gco:Boolean>
                        </gmd:pass>
                      </gmd:DQ_ConformanceResult>
                    </gmd:result>
                  </gmd:DQ_DomainConsistency>
                </gmd:report>
              </snippet>
            </template>
          </action>

          <action type="add" or="report"
                  btnLabel="sds-category"
                  in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                  if="gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification/srv:serviceType/
                  gco:LocalName/text()='other' and count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/
                  gmd:DQ_DomainConsistency/gmd:result/gmd:DQ_ConformanceResult[gmd:specification/
                  gmd:CI_Citation/gmd:title/gmx:Anchor/text()!='invocable']) = 0">
            <template>
              <snippet>
                <gmd:report>
                  <gmd:DQ_DomainConsistency>
                    <gmd:result>
                      <gmd:DQ_ConformanceResult>
                        <gmd:specification>
                          <gmd:CI_Citation>
                            <gmd:title>
                              <gmx:Anchor
                                xlink:href="http://inspire.ec.europa.eu/id/ats/metadata/2.0/sds-invocable"
                                xlink:title="INSPIRE Invocable Spatial Data Services metadata">
                                invocable
                              </gmx:Anchor>
                            </gmd:title>
                            <gmd:date>
                              <gmd:CI_Date>
                                <gmd:date>
                                  <gco:Date>2016-05-01</gco:Date>
                                </gmd:date>
                                <gmd:dateType>
                                  <gmd:CI_DateTypeCode
                                    codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode"
                                    codeListValue="publication"/>
                                </gmd:dateType>
                              </gmd:CI_Date>
                            </gmd:date>
                          </gmd:CI_Citation>
                        </gmd:specification>
                        <gmd:explanation>
                          <gco:CharacterString>Questo servizio di dati territoriali è conforme ai requisiti INSPIRE per i Servizi di Dati Territoriali Invocabili</gco:CharacterString>
                        </gmd:explanation>
                        <gmd:pass>
                          <gco:Boolean>true</gco:Boolean>
                        </gmd:pass>
                      </gmd:DQ_ConformanceResult>
                    </gmd:result>
                  </gmd:DQ_DomainConsistency>
                </gmd:report>
              </snippet>
            </template>
          </action>

          <field
            xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:scope/gmd:DQ_Scope/gmd:level"/>

          <action type="process"
                  process="sds-add-dataquality"
                  if="count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality[gmd:scope/gmd:DQ_Scope/gmd:level/gmd:MD_ScopeCode/@codeListValue='service'])=0
            and count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0"/>

          <field
            xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_ConceptualConsistency"/>

          <action type="process"
                  process="sds-add-qualityofservice"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/srv:SV_ServiceIdentification) > 0"/>




          <section name="positionalAccuracy" displayIfRecord="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0">


            <field xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/
            gmd:report/gmd:DQ_AbsoluteExternalPositionalAccuracy/gmd:result/gmd:DQ_QuantitativeResult/gmd:value/gco:Record"
            />

            <action type="add"
                    btnLabel="positionalAccuracy"
                    or="report"
                    in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                    if="count(gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_AbsoluteExternalPositionalAccuracy/gmd:result)=0"
            >
              <template>
                <snippet>
                  <gmd:report>
                    <gmd:DQ_AbsoluteExternalPositionalAccuracy>
                      <gmd:result>
                        <gmd:DQ_QuantitativeResult>
                          <gmd:valueUnit>
                            <gml:BaseUnit gml:id="m">
                              <gml:identifier
                                codeSpace="http://www.bipm.org/en/si/base_units">m</gml:identifier>
                              <gml:unitsSystem
                                xlink:href="http://www.bipm.org/en/si"/>
                            </gml:BaseUnit>
                          </gmd:valueUnit>
                          <gmd:value>
                            <gco:Record>
                              <gco:Real>0.0</gco:Real>
                            </gco:Record>
                          </gmd:value>
                        </gmd:DQ_QuantitativeResult>
                      </gmd:result>
                    </gmd:DQ_AbsoluteExternalPositionalAccuracy>
                  </gmd:report>
                </snippet>
              </template>
            </action>
          </section>

          <field xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:report/gmd:DQ_TopologicalConsistency">
            <template>
              <values>
                <key label="name_of_measures"
                     xpath="gmd:nameOfMeasure/gco:CharacterString">
                </key>
                <key label="evaluation_method_type"
                     xpath="gmd:evaluationMethodType/gmd:DQ_EvaluationMethodTypeCode"
                />
                <key label="evaluation_method_descr"
                     xpath="gmd:evaluationMethodDescription/gco:CharacterString"
                />
                <key label="conformity_date"
                     xpath="gmd:date/gco:DateTime"
                     use="gn-date-picker">
                  <directiveAttributes data-tag-name="gco:DateTime"/>
                </key>
                <key label="value_unit"
                     xpath="gmd:result/gmd:DQ_QuantitativeResult/gmd:valueUnit/@xlink:href"
                     />
                <key label="topological_record"
                     xpath="gmd:result/gmd:DQ_QuantitativeResult/gmd:value/gco:Record"
                />
              </values>
              <snippet>
                <gmd:DQ_TopologicalConsistency>
                  <gmd:nameOfMeasure>
                    <gco:CharacterString>{{name_of_measure}}</gco:CharacterString>
                  </gmd:nameOfMeasure>
                  <gmd:evaluationMethodType>
                    {{evaluation_method_type}}
                  </gmd:evaluationMethodType>
                  <gmd:evaluationMethodDescription>
                    <gco:CharacterString>{{evaluation_method_descr}}</gco:CharacterString>
                  </gmd:evaluationMethodDescription>
                  <gmd:dateTime>
                    {{date_time}}
                  </gmd:dateTime>
                  <gmd:result>
                    <gmd:DQ_QuantitativeResult>
                      <gmd:valueUnit
                        xlink:href="{{value_unit}}"/>
                      <gmd:value>
                        <gco:Record xmlns:xs="http://www.w3.org/2001/XMLSchema"
                                    xsi:type="xs:integer">{{topological_record}}</gco:Record>
                      </gmd:value>
                    </gmd:DQ_QuantitativeResult>
                  </gmd:result>
                </gmd:DQ_TopologicalConsistency>
              </snippet>
            </template>
          </field>

          <action type ="add" or ="report" btnLabel="topologicalConsistency"
                  in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality"
                  if="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0">
            <template>
              <snippet>
                <gmd:report>
                  <gmd:DQ_TopologicalConsistency>
                    <gmd:nameOfMeasure>
                      <gco:CharacterString/>
                    </gmd:nameOfMeasure>
                    <gmd:evaluationMethodType>
                      <gmd:DQ_EvaluationMethodTypeCode
                        codeList="http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#DQ_EvaluationMethodTypeCode"
                        codeListValue="indirect"/>
                    </gmd:evaluationMethodType>
                    <gmd:evaluationMethodDescription>
                      <gco:CharacterString/>
                    </gmd:evaluationMethodDescription>
                    <gmd:dateTime>
                      <gco:DateTime></gco:DateTime>
                    </gmd:dateTime>
                    <gmd:result>
                      <gmd:DQ_QuantitativeResult>
                        <gmd:valueUnit
                          xlink:href="http://www.opengis.net/def/uom/OGC/1.0/unity"/>
                        <gmd:value>
                          <gco:Record xmlns:xs="http://www.w3.org/2001/XMLSchema"
                                      xsi:type="xs:integer"/>
                        </gmd:value>
                      </gmd:DQ_QuantitativeResult>
                    </gmd:result>
                  </gmd:DQ_TopologicalConsistency>
                </gmd:report>
              </snippet>
            </template>
          </action>

          <field name="lineage"
                 xpath="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:lineage/gmd:LI_Lineage/gmd:statement"/>

          <action type="add" name="lineage" or="statement" btnLabel="lineage"
                  in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality/gmd:lineage/gmd:LI_Lineage">
            <template>
              <snippet>
                <gmd:statement>
                  <gco:CharacterString></gco:CharacterString>
                </gmd:statement>
              </snippet>
            </template>
          </action>
          <action type="add" name="lineage" or="lineage" btnLabel="lineage"
                  in="/gmd:MD_Metadata/gmd:dataQualityInfo/gmd:DQ_DataQuality">
            <template>
              <snippet>
                <gmd:lineage>
                  <gmd:LI_Lineage>
                    <gmd:statement>
                      <gco:CharacterString></gco:CharacterString>
                    </gmd:statement>
                  </gmd:LI_Lineage>
                </gmd:lineage>
              </snippet>
            </template>
          </action>
        </section>
      </tab>
      <tab id ="contentInfo" displayIfRecord="count(gmd:MD_Metadata/gmd:contentInfo)>0">
        <section xpath ="gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription"
                 or="MD_ImageDescription"
                 in="gmd:MD_Metadata/gmd:contentInfo"
                 />
      </tab>
      <tab id="spatialRepresentation"  displayIfRecord="count(gmd:MD_Metadata/gmd:contentInfo/gmd:MD_ImageDescription)>0">
        <section xpath="/gmd:MD_Metadata/gmd:spatialRepresentationInfo"
                 or="spatialRepresentationInfo"
                 in="/gmd:MD_Metadata"
        />
      </tab>
      <tab id="referenceSystemInfo" displayIfRecord="count(gmd:MD_Metadata/gmd:identificationInfo/gmd:MD_DataIdentification) > 0">
        <section xpath="/gmd:MD_Metadata/gmd:referenceSystemInfo" or="gmd:referenceSystemInfo" in="gmd:MD_Metadata"/>
      </tab>
    </view>

    <view name="xml">
      <sidePanel>
        <directive data-gn-validation-report=""/>
        <directive data-gn-onlinesrc-list=""/>
        <directive gn-geo-publisher=""
                   data-ng-if="gnCurrentEdit.geoPublisherConfig"
                   data-config="{{gnCurrentEdit.geoPublisherConfig}}"
                   data-lang="lang"/>
        <directive data-gn-suggestion-list=""/>
        <directive data-gn-need-help="user-guide/describing-information/creating-metadata.html"/>
      </sidePanel>
      <tab id="xml" default="true"/>
    </view>
  </views>
</editor>
